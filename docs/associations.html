<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.180">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nathan Contantine-Cooke 1, 2">
<meta name="author" content="Karla Monterrubio 1">
<meta name="author" content="Riccardo Marioni 2">
<meta name="author" content="Catalina A. Vallejos 1, 3">
<title>Analysis by Constantine-Cooke et al.&nbsp;- Association Testing</title>
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
    }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<script src="site_libs/quarto-nav/quarto-nav.js"></script><script src="site_libs/quarto-nav/headroom.min.js"></script><script src="site_libs/clipboard/clipboard.min.js"></script><meta name="quarto:offset" content="./">
<script src="site_libs/quarto-search/autocomplete.umd.js"></script><script src="site_libs/quarto-search/fuse.min.js"></script><script src="site_libs/quarto-search/quarto-search.js"></script><script src="site_libs/quarto-html/quarto.js"></script><script src="site_libs/quarto-html/popper.min.js"></script><script src="site_libs/quarto-html/tippy.umd.min.js"></script><script src="site_libs/quarto-html/anchor.min.js"></script><link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="site_libs/bootstrap/bootstrap.min.js"></script><link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script><script defer="" src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]--><link rel="stylesheet" href="theme.css">
<meta name="citation_title" content="Association Testing">
<meta name="citation_author" content="Nathan Contantine-Cooke &amp;amp;lt;sup&amp;gt;1, 2</sup>">
<meta name="citation_author" content="Karla Monterrubio &amp;amp;lt;sup&amp;gt;1</sup>">
<meta name="citation_author" content="Riccardo Marioni &amp;amp;lt;sup&amp;gt;2</sup>">
<meta name="citation_author" content="Catalina A. Vallejos &amp;amp;lt;sup&amp;gt;1, 3</sup>">
<meta name="citation_online_date" content="2022-08-11">
<meta name="citation_publication_date" content="2022-08-11">
<meta name="citation_journal_title" content="undefined">
<meta name="citation_reference" content="citation_title=Normalization of fecal calprotectin within 12 months of diagnosis is associated with reduced risk of disease progression in patients with Crohn’s disease;,citation_author=Nikolas Plevris;,citation_author=James Fulforth;,citation_author=Mathew Lyons;,citation_author=Spyros I. Siakavellas;,citation_author=Philip W. Jenkinson;,citation_author=Cher S. Chuah;,citation_author=Laura Lucaciu;,citation_author=Rebecca J. Pattenden;,citation_author=Ian D. Arnott;,citation_author=Gareth-Rhys Jones;,citation_author=Charlie W. Lees;,citation_publication_date=2021-09;,citation_issue=9;,citation_volume=19;,citation_journal_title=Clinical Gastroenterology and Hepatology;">
<meta name="citation_reference" content="citation_title=Ulcerative colitis and clinical course: Results of a 5-year population-based follow-up study (the IBSEN study);,citation_author=Magne Henriksen;,citation_author=Jrgen Jahnsen;,citation_author=Idar Lygren;,citation_author=Jostein Sauar;,citation_author=undefined Kjellevold;,citation_author=Tom Schulz;,citation_author=Morten H. Vatn;,citation_author=Bjrn Moum;,citation_publication_date=2006-07;,citation_issue=7;,citation_volume=12;,citation_journal_title=Inflammatory Bowel Diseases;">
<meta name="citation_reference" content="citation_title=Polynomials and potential theory for gaussian radial basis function interpolation;,citation_author=Rodrigo B. Platte;,citation_author=Tobin A. Driscoll;,citation_fulltext_html_url=https://doi.org/10.1137/040610143;,citation_publication_date=2005;,citation_issue=2;,citation_volume=43;,citation_journal_title=SIAM Journal on Numerical Analysis;">
<meta name="citation_reference" content="citation_title=Estimation of extended mixed models using latent classes and latent processes: The R package lcmm;,citation_author=Cécile Proust-Lima;,citation_author=Viviane Philipps;,citation_author=Benoit Liquet;,citation_publication_date=2017;,citation_issue=2;,citation_volume=78;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Regression modeling strategies;,citation_author=undefined Frank E. Harrell;,citation_publication_date=2015;,citation_journal_title=undefined;">
<meta name="citation_reference" content="citation_title=The runge phenomenon and spatially variable shape parameters in RBF interpolation;,citation_author=Bengt Fornberg;,citation_author=Julia Zuev;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0898122107002210;,citation_publication_date=2007;,citation_issue=3;,citation_issn=0898-1221;,citation_volume=54;,citation_journal_title=Computers &amp;amp;amp; Mathematics with Applications;">
<meta name="citation_reference" content="citation_title=Using linear and natural cubic splines, SITAR, and latent trajectory models to characterise nonlinear longitudinal growth trajectories in cohort studies;,citation_author=Ahmed Elhakeem;,citation_author=Rachael A. Hughes;,citation_author=Kate Tilling;,citation_author=Diana L. Cousminer;,citation_author=Stefan A. Jackowski;,citation_author=Tim J. Cole;,citation_author=Alex S. F. Kwong;,citation_author=Zheyuan Li;,citation_author=Struan F. A. Grant;,citation_author=Adam D. G. Baxter-Jones;,citation_author=Babette S. Zemel;,citation_author=Deborah A. Lawlor;,citation_fulltext_html_url=https://doi.org/10.1186/s12874-022-01542-8;,citation_publication_date=2022;,citation_issue=1;,citation_isbn=1471-2288;,citation_volume=22;,citation_journal_title=BMC Medical Research Methodology;">
<meta name="citation_reference" content="citation_title=Asymptotically efficient rank invariant test procedures;,citation_author=Richard Peto;,citation_author=Julian Peto;,citation_publication_date=1972;,citation_issue=2;,citation_volume=135;,citation_journal_title=Journal of the Royal Statistical Society. Series A (General);">
</head>
<body>
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analysis by Constantine-Cooke et al.</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-cleaning.html">Data Cleaning</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./selection.html">Model Selection</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./associations.html" aria-current="page">Association Testing</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vallejosgroup/lcmm-site"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc"><h2 id="toc-title">On this page</h2>
<ul>
<li><a href="#introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
<li><a href="#outcomes" class="nav-link" data-scroll-target="#outcomes">Outcomes</a></li>
<li><a href="#characteristics-available-at-diagnosis" class="nav-link" data-scroll-target="#characteristics-available-at-diagnosis">Characteristics available at diagnosis</a></li>
<li><a href="#treatment-effects" class="nav-link" data-scroll-target="#treatment-effects">Treatment effects</a></li>
<li>
<a href="#predictive-models" class="nav-link" data-scroll-target="#predictive-models">Predictive models</a>
<ul class="collapse">
<li><a href="#all-classes" class="nav-link" data-scroll-target="#all-classes">All classes</a></li>
<li><a href="#class-2-16" class="nav-link" data-scroll-target="#class-2-16">Class 2</a></li>
</ul>
</li>
<li><a href="#session-information" class="nav-link" data-scroll-target="#session-information">Session information</a></li>
<li><a href="#section" class="nav-link" data-scroll-target="#section"></a></li>
<li><a href="#acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
<li><a href="#author-contributions" class="nav-link" data-scroll-target="#author-contributions">Author contributions</a></li>
<li><a href="#reuse" class="nav-link" data-scroll-target="#reuse">Reuse</a></li>
</ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/vallejosgroup/lcmm-site/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title-block"><div><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>






<div class="quarto-title"><h1 class="title">Association Testing</h1><p class="subtitle lead">Comparing demographic data, clinical data, and outcomes across classes.</p></div><div class="quarto-title-meta"><div><div class="quarto-title-meta-heading">Authors</div><div class="quarto-title-meta-contents"><div class="quarto-title-authors"><div><a href="https://scholar.google.com/citations?user=2emHWR0AAAAJ&amp;hl=en&amp;oi=ao">
<p>Nathan Contantine-Cooke <sup>1, 2</sup></p>
</a></div><div><a href="https://scholar.google.com/citations?user=YmyxSXAAAAAJ&amp;hl=en">
<p>Karla Monterrubio <sup>1</sup></p>
</a></div><div><a href="https://scholar.google.com/citations?hl=en&amp;user=gA3Ik3MAAAAJ">
<p>Riccardo Marioni <sup>2</sup></p>
</a></div><div><a href="https://scholar.google.com/citations?user=lkdrwm0AAAAJ&amp;hl=en&amp;oi=ao">
<p>Catalina A. Vallejos <sup>1, 3</sup></p>
</a></div></div></div></div><div><div class="quarto-title-meta-heading">Affilliations</div><div class="quarto-title-meta-contents"><div class="quarto-title-affiliations"><p><a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
<p><sup>1</sup> MRC Human Genetics Unit</p>
</a></p><p><a href="https://www.ed.ac.uk/centre-genomic-medicine">
<p><sup>2</sup> Centre for Genomic and Experimental Medicine</p>
</a></p><p><a href="https://www.turing.ac.uk">
<p><sup>3</sup> The Alan Turing Institute</p>
</a></p><p>&nbsp;</p></div></div></div><div><div class="quarto-title-meta-heading">Published</div><div class="quarto-title-meta-contents"><p class="date">August 11, 2022</p></div></div></div></header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span> <span class="co"># Multinomial logistic regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span> <span class="co"># Modelling framework</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger">ranger</a></span><span class="op">)</span> <span class="co"># Random forest</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span> <span class="co"># Kaplan-Meier</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html">survminer</a></span><span class="op">)</span> <span class="co"># Plot Kaplan-Meier curves</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/koalaverse/vip/">vip</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"plyr"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">########################</span></span>
<span><span class="co">#-- Custom Functions --#</span></span>
<span><span class="co">########################</span></span>
<span></span>
<span><span class="co">#' @title Calculate descriptive statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @param vars Character vector of continuous variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Finds the median, first quartile, third quartile, minimum and maximum</span></span>
<span><span class="co">#'   statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 7 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cont</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">out_desc</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">med</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#' @title Calculate descriptive statistics for categorical variables</span></span>
<span><span class="co">#' @param vars Character vector of categorical variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Prints frequency and proportional tables for given categorical variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 3 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">kaplan_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">title</span>, <span class="va">subtitle</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">legend</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">legend</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subtitle</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span>, <span class="st">"Stratified by class"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After <a href="./selection.html">deeming the four-class LCMM to be the most suitable</a>, we will now explore potential associations with class membership. We will consider variables typically available at diagnosis, outcomes usually indicative of a poor disease course, and treatments prescribed within one year of diagnosis. For all categorical variables, frequency tables for the study population and classes have been generated in addition to either chi-squared test or (if a cell has &lt; 5 observations) Fisher’s exact test results. For continuous variables, the median, first quartile, and third quartile have been reported for the study population and classes in addition to ANOVA results.</p>
<p>To streamline the analysis, descriptive functions have been created, <code>describe_cat()</code> and <code>describe_cont()</code> which generate the aforementioned results</p>
<p>We also attempt to predict class membership based on these variables to determine if class membership can be accurately predicted ahead of time using these variables. We consider both multinomial logistic regression and random forest predictive models for this purpose.</p>
</section><section id="outcomes" class="level2"><h2 class="anchored" data-anchor-id="outcomes">Outcomes</h2>
<p>We will first consider associations with outcomes in order to determine if there is are potentially clinically significant aspects to these classes. For this purpose, we use Kaplan-Meier curves for endpoints of interest stratified by class membership. The endpoints considered are hospitalisation, surgery, disease progression, and a composite end point. We use log-rank tests to determine if survival distributions differ across classes. All censoring indicators have been mapped to 0 (censored) and 1 (observed). Patients who met one of these endpoints within one year of diagnosis were excluded from the Crohn’s disease inception cohort and therefore no endpoints are observed within one year of diagnosis for the study cohort. For more information, see the <a href="./data-cleaning.html">Data Cleaning Section</a>.</p>
<p>For log rank tests, we consider both Mantel-Haenszel tests and modified Gehan-Wilcoxon tests <span class="citation" data-cites="Peto1972">(<a href="#ref-Peto1972" role="doc-biblioref">Peto and Peto 1972</a>)</span> for robustness against assumptions.</p>
<p>We have found the survival distributions for hospitalisation, disease progression, and the composite endpoint to be significantly different across classes but not the survival distribution for the surgery endpoint.</p>
<p>From the below plots, we can clearly see class 1, which is characterised by a decrease in FCAL, results in high survival probabilities over time. Class 2, distinguished by consistently high FCAL, demonstrates poor survival probabilities.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/processed-data/cdi/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"cache/cubicbf.fits.RDS"</span><span class="op">)</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                                     from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                     to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/data/"</span>,</span>
<span>                               <span class="st">"crohns-inception/20220328/"</span>,</span>
<span>                               <span class="st">"Nathan_FCprogressioncohort.csv"</span><span class="op">)</span></span>
<span>                         <span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">Number</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"id"</span></span>
<span><span class="va">classes</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">classes</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Hospitalisation</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Surgery</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Disease progression</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Composite endpoint</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labeledby="tabset-1-1-tab">
<section id="mantel-haenszel-test" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"hosp"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"hosp.date"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="va">hosp.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="va">hosp.time</span></span>
<span></span>
<span><span class="va">hosp.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">hosp.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">hosp.model</span>, <span class="st">"Kaplan-Meier Curves for Hospitalisation"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="modified-gehan-wilcoxon-test" class="level4"><h4 class="anchored" data-anchor-id="modified-gehan-wilcoxon-test">Modified Gehan-Wilcoxon Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">hosp.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(hosp.time, hosp.censor) ~ class Chisq = 16.742341 on 3 degrees of freedom, p = 0.000798</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>class=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">10.01</td>
<td style="text-align: center;">24.57</td>
<td style="text-align: center;">8.622</td>
<td style="text-align: center;">14.23</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">60.78</td>
<td style="text-align: center;">45.53</td>
<td style="text-align: center;">5.113</td>
<td style="text-align: center;">12.46</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>class=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">14.17</td>
<td style="text-align: center;">15.62</td>
<td style="text-align: center;">0.1336</td>
<td style="text-align: center;">0.1975</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">4.484</td>
<td style="text-align: center;">3.744</td>
<td style="text-align: center;">0.1464</td>
<td style="text-align: center;">0.1796</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labeledby="tabset-1-2-tab">
<section id="mantel-haenszel-test-1" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-1">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"surg"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"surg.date"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="va">surg.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="va">surg.time</span></span>
<span></span>
<span><span class="va">surg.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">surg.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">surg.model</span>, <span class="st">"Kaplan-Meier Curves for Surgery"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="modified-gehan-wilcoxon-test-1" class="level4"><h4 class="anchored" data-anchor-id="modified-gehan-wilcoxon-test-1">Modified Gehan-Wilcoxon Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">surg.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(surg.time, surg.censor) ~ class Chisq = 2.780636 on 3 degrees of freedom, p = 0.426698</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>class=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">6.389</td>
<td style="text-align: center;">10.35</td>
<td style="text-align: center;">1.516</td>
<td style="text-align: center;">2.194</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">25.25</td>
<td style="text-align: center;">22.62</td>
<td style="text-align: center;">0.3064</td>
<td style="text-align: center;">0.7259</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>class=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">7.512</td>
<td style="text-align: center;">7.306</td>
<td style="text-align: center;">0.005816</td>
<td style="text-align: center;">0.007715</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: center;">1.698</td>
<td style="text-align: center;">0.7414</td>
<td style="text-align: center;">0.8281</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labeledby="tabset-1-3-tab">
<section id="mantel-haenszel-test-2" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-2">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"prog"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"prog.date"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="va">prog.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="va">prog.time</span></span>
<span><span class="va">prog.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">prog.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">prog.model</span>, <span class="st">"Kaplan-Meier Curves for Disease Progression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="modified-gehan-wilcoxon-test-2" class="level4"><h4 class="anchored" data-anchor-id="modified-gehan-wilcoxon-test-2">Modified Gehan-Wilcoxon Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">prog.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(prog.time, prog.censor) ~ class Chisq = 21.551506 on 3 degrees of freedom, p = 0.000081</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>class=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">1.803</td>
<td style="text-align: center;">15.39</td>
<td style="text-align: center;">11.99</td>
<td style="text-align: center;">18.26</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">45.58</td>
<td style="text-align: center;">31.11</td>
<td style="text-align: center;">6.735</td>
<td style="text-align: center;">16.08</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>class=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">10.17</td>
<td style="text-align: center;">10.13</td>
<td style="text-align: center;">0.0002011</td>
<td style="text-align: center;">0.0002753</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">1.837</td>
<td style="text-align: center;">2.774</td>
<td style="text-align: center;">0.3164</td>
<td style="text-align: center;">0.3714</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labeledby="tabset-1-4-tab">
<section id="mantel-haenszel-test-3" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-3">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"composite"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"composites.day"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="va">composite.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="va">composite.time</span> <span class="op">/</span> <span class="fl">365.25</span></span>
<span></span>
<span><span class="va">comp.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">composite.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">comp.model</span>, <span class="st">"Kaplan-Meier Curves for Composite Endpoint"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="modified-gehan-wilcoxon-test-3" class="level4"><h4 class="anchored" data-anchor-id="modified-gehan-wilcoxon-test-3">Modified Gehan-Wilcoxon Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">composite.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">class</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(composite.time, composite.censor) ~ class Chisq = 18.230988 on 3 degrees of freedom, p = 0.000394</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>class=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">13.48</td>
<td style="text-align: center;">30.31</td>
<td style="text-align: center;">9.346</td>
<td style="text-align: center;">16.39</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">70.5</td>
<td style="text-align: center;">56.43</td>
<td style="text-align: center;">3.508</td>
<td style="text-align: center;">9.146</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>class=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">19.2</td>
<td style="text-align: center;">19.01</td>
<td style="text-align: center;">0.001754</td>
<td style="text-align: center;">0.002769</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>class=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">6.863</td>
<td style="text-align: center;">4.284</td>
<td style="text-align: center;">1.553</td>
<td style="text-align: center;">1.996</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="characteristics-available-at-diagnosis" class="level2"><h2 class="anchored" data-anchor-id="characteristics-available-at-diagnosis">Characteristics available at diagnosis</h2>
<p>We have found two variables available at diagnosis to be associated with class membership: smoking at diagnosis (<span class="math inline">p = 0.015</span>) and upper gastrointestinal inflammation (Montreal L4; <span class="math inline">p &lt; 0.001</span>).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Sex</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Age at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Smoking at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Diagnostic FCAL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Montreal behaviour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Perianal</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Montreal location</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Upper GI</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labeledby="tabset-2-1-tab">
<section id="population" class="level4"><h4 class="anchored" data-anchor-id="population">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
 173  183    0 

        F         M      &lt;NA&gt; 
0.4859551 0.5140449 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1" class="level4"><h4 class="anchored" data-anchor-id="class-1">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  49   43    0 

        F         M      &lt;NA&gt; 
0.5326087 0.4673913 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2" class="level4"><h4 class="anchored" data-anchor-id="class-2">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  84  107    0 

        F         M      &lt;NA&gt; 
0.4397906 0.5602094 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3" class="level4"><h4 class="anchored" data-anchor-id="class-3">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  34   24    0 

        F         M      &lt;NA&gt; 
0.5862069 0.4137931 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4" class="level4"><h4 class="anchored" data-anchor-id="class-4">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
   6    9    0 

   F    M &lt;NA&gt; 
 0.4  0.6  0.0 </code></pre>
</div>
</div>
</section><section id="chi-squared-test" class="level4"><h4 class="anchored" data-anchor-id="chi-squared-test">Chi-squared test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">SEX</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  demographic$SEX and demographic$class
X-squared = 5.2083, df = 3, p-value = 0.1572</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-2-tab">
<section id="population-1" class="level4"><h4 class="anchored" data-anchor-id="population-1">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable   n Median Q1   Q3  Min  Max
1      age 356   27.3 16 48.7 3.75 87.1</code></pre>
</div>
</div>
</section><section id="class-1-1" class="level4"><h4 class="anchored" data-anchor-id="class-1-1">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 92   29.6 20.4 45.3 6.87 87.1</code></pre>
</div>
</div>
</section><section id="class-2-1" class="level4"><h4 class="anchored" data-anchor-id="class-2-1">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable   n Median   Q1   Q3  Min  Max
1      age 191   26.4 15.3 49.9 3.75 81.3</code></pre>
</div>
</div>
</section><section id="class-3-1" class="level4"><h4 class="anchored" data-anchor-id="class-3-1">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 58   26.8 15.1 50.9 4.98 78.4</code></pre>
</div>
</div>
</section><section id="class-4-1" class="level4"><h4 class="anchored" data-anchor-id="class-4-1">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 15   21.7 14.5 51.2 10.5 71.3</code></pre>
</div>
</div>
</section><section id="anova" class="level4"><h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
class         1     14    14.5   0.036  0.851
Residuals   354 144163   407.2               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-3-tab">
<p>If a participant has reported to have not smoked in the past, then it is assumed the participant did not smoke at IBD diagnosis. Otherwise smoking status is taken from the participant’s response to being asked if they were smoking when diagnosed with IBD.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"SMOKER..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"smoking"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-2" class="level4"><h4 class="anchored" data-anchor-id="population-2">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 286   70    0 

       no       yes      &lt;NA&gt; 
0.8033708 0.1966292 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-2" class="level4"><h4 class="anchored" data-anchor-id="class-1-2">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  70   22    0 

       no       yes      &lt;NA&gt; 
0.7608696 0.2391304 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-2" class="level4"><h4 class="anchored" data-anchor-id="class-2-2">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 148   43    0 

       no       yes      &lt;NA&gt; 
0.7748691 0.2251309 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-2" class="level4"><h4 class="anchored" data-anchor-id="class-3-2">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  54    4    0 

        no        yes       &lt;NA&gt; 
0.93103448 0.06896552 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-4-2" class="level4"><h4 class="anchored" data-anchor-id="class-4-2">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  14    1    0 

        no        yes       &lt;NA&gt; 
0.93333333 0.06666667 0.00000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$smoking
p-value = 0.01455
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-4-tab">
<section id="population-3" class="level4"><h4 class="anchored" data-anchor-id="population-3">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/processed-data/cdi/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="va">FCcumulative</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">FCcumulative</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span></span>
<span>  <span class="va">subject.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">DiagFC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">subject.data</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"value"</span><span class="op">]</span> <span class="co"># Already sorted by time</span></span>
<span><span class="op">}</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="va">DiagFC</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 356    820 590 1140 250 2500</code></pre>
</div>
</div>
</section><section id="class-1-3" class="level4"><h4 class="anchored" data-anchor-id="class-1-3">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median  Q1  Q3 Min  Max
1   DiagFC 92    725 500 986 253 2500</code></pre>
</div>
</div>
</section><section id="class-2-3" class="level4"><h4 class="anchored" data-anchor-id="class-2-3">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 191    900 610 1270 250 2500</code></pre>
</div>
</div>
</section><section id="class-3-3" class="level4"><h4 class="anchored" data-anchor-id="class-3-3">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 58    825 592 1180 310 2500</code></pre>
</div>
</div>
</section><section id="class-4-3" class="level4"><h4 class="anchored" data-anchor-id="class-4-3">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 15    660 630 1160 470 2040</code></pre>
</div>
</div>
</section><section id="anova-1" class="level4"><h4 class="anchored" data-anchor-id="anova-1">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DiagFC</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1    676441  676441   2.295  0.131
Residuals   354 104332274  294724               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BEHAVIOUR.AT.DIAGNOSIS"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"behaviour"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-4" class="level4"><h4 class="anchored" data-anchor-id="population-4">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 323   30    3    0 

          1           2           3        &lt;NA&gt; 
0.907303371 0.084269663 0.008426966 0.000000000 </code></pre>
</div>
</div>
</section><section id="class-1-4" class="level4"><h4 class="anchored" data-anchor-id="class-1-4">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  80   10    2    0 

         1          2          3       &lt;NA&gt; 
0.86956522 0.10869565 0.02173913 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-2-4" class="level4"><h4 class="anchored" data-anchor-id="class-2-4">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 175   15    1    0 

          1           2           3        &lt;NA&gt; 
0.916230366 0.078534031 0.005235602 0.000000000 </code></pre>
</div>
</div>
</section><section id="class-3-4" class="level4"><h4 class="anchored" data-anchor-id="class-3-4">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  55    3    0    0 

         1          2          3       &lt;NA&gt; 
0.94827586 0.05172414 0.00000000 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-4-4" class="level4"><h4 class="anchored" data-anchor-id="class-4-4">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  13    2    0    0 

        1         2         3      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-1" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-1">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$behaviour
p-value = 0.4937
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"PERIANAL.DISEASE..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"peri"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-5" class="level4"><h4 class="anchored" data-anchor-id="population-5">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 299   57    0 

       no       yes      &lt;NA&gt; 
0.8398876 0.1601124 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-5" class="level4"><h4 class="anchored" data-anchor-id="class-1-5">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  75   17    0 

       no       yes      &lt;NA&gt; 
0.8152174 0.1847826 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-5" class="level4"><h4 class="anchored" data-anchor-id="class-2-5">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 163   28    0 

       no       yes      &lt;NA&gt; 
0.8534031 0.1465969 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-5" class="level4"><h4 class="anchored" data-anchor-id="class-3-5">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  49    9    0 

       no       yes      &lt;NA&gt; 
0.8448276 0.1551724 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-5" class="level4"><h4 class="anchored" data-anchor-id="class-4-5">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  12    3    0 

  no  yes &lt;NA&gt; 
 0.8  0.2  0.0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-2" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-2">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">peri</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$peri
p-value = 0.7757
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span>, <span class="st">"L3"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-6" class="level4"><h4 class="anchored" data-anchor-id="population-6">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  95  140  121    0 

       L1        L2        L3      &lt;NA&gt; 
0.2668539 0.3932584 0.3398876 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-6" class="level4"><h4 class="anchored" data-anchor-id="class-1-6">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  22   39   31    0 

       L1        L2        L3      &lt;NA&gt; 
0.2391304 0.4239130 0.3369565 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-6" class="level4"><h4 class="anchored" data-anchor-id="class-2-6">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  58   68   65    0 

       L1        L2        L3      &lt;NA&gt; 
0.3036649 0.3560209 0.3403141 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-6" class="level4"><h4 class="anchored" data-anchor-id="class-3-6">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   9   30   19    0 

       L1        L2        L3      &lt;NA&gt; 
0.1551724 0.5172414 0.3275862 0.0000000 </code></pre>
</div>
</div>
<section id="class-4-6" class="level5"><h5 class="anchored" data-anchor-id="class-4-6">Class = 4</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   6    3    6    0 

  L1   L2   L3 &lt;NA&gt; 
 0.4  0.2  0.4  0.0 </code></pre>
</div>
</div>
</section></section><section id="fishers-exact-test-3" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-3">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, workspace <span class="op">=</span> <span class="fl">800000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$LOCATION
p-value = 0.125
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labeledby="tabset-2-8-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"L4.Modifier"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"L4"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-7" class="level4"><h4 class="anchored" data-anchor-id="population-7">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 272   84    0 

       no       yes      &lt;NA&gt; 
0.7640449 0.2359551 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-7" class="level4"><h4 class="anchored" data-anchor-id="class-1-7">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  84    8    0 

        no        yes       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-2-7" class="level4"><h4 class="anchored" data-anchor-id="class-2-7">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 140   51    0 

       no       yes      &lt;NA&gt; 
0.7329843 0.2670157 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-7" class="level4"><h4 class="anchored" data-anchor-id="class-3-7">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  38   20    0 

       no       yes      &lt;NA&gt; 
0.6551724 0.3448276 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-7" class="level4"><h4 class="anchored" data-anchor-id="class-4-7">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  10    5    0 

       no       yes      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-4" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-4">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">L4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$L4
p-value = 0.0002175
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="treatment-effects" class="level2"><h2 class="anchored" data-anchor-id="treatment-effects">Treatment effects</h2>
<p>To explore the potential presence of treatment effects, we have tested for associations between class membership and common IBD prescriptions. All treatments were prescribed within one year of diagnosis unless otherwise stated. Thiprine use (<span class="math inline">p = 0.02</span>), biologic use within three months of diagnosis (<span class="math inline">p &lt; 0.001</span>), and biologic use within one year of diagnosis (<span class="math inline">p &lt; 0.001</span>) were found to be significantly associated with class membership.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">5ASA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Thioprine</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Corticosteroids</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Methotrexate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">EEN</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Biologic use within three months</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">Biologic use within one year</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-8" role="tab" aria-controls="tabset-3-8" aria-selected="false">Date of diagnosis</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labeledby="tabset-3-1-tab">
<section id="population-8" class="level4"><h4 class="anchored" data-anchor-id="population-8">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 280   76    0 

        N         Y      &lt;NA&gt; 
0.7865169 0.2134831 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-8" class="level4"><h4 class="anchored" data-anchor-id="class-1-8">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  77   15    0 

        N         Y      &lt;NA&gt; 
0.8369565 0.1630435 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-8" class="level4"><h4 class="anchored" data-anchor-id="class-2-8">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 143   48    0 

        N         Y      &lt;NA&gt; 
0.7486911 0.2513089 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-8" class="level4"><h4 class="anchored" data-anchor-id="class-3-8">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  47   11    0 

        N         Y      &lt;NA&gt; 
0.8103448 0.1896552 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-8" class="level4"><h4 class="anchored" data-anchor-id="class-4-8">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  13    2    0 

        N         Y      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-5" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-5">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">X5ASA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$X5ASA
p-value = 0.3261
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"THIOPURINE.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_thio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-9" class="level4"><h4 class="anchored" data-anchor-id="population-9">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 106  250    0 

        N         Y      &lt;NA&gt; 
0.2977528 0.7022472 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-9" class="level4"><h4 class="anchored" data-anchor-id="class-1-9">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  30   62    0 

       N        Y     &lt;NA&gt; 
0.326087 0.673913 0.000000 </code></pre>
</div>
</div>
</section><section id="class-2-9" class="level4"><h4 class="anchored" data-anchor-id="class-2-9">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  64  127    0 

        N         Y      &lt;NA&gt; 
0.3350785 0.6649215 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-9" class="level4"><h4 class="anchored" data-anchor-id="class-3-9">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb131"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   8   50    0 

       N        Y     &lt;NA&gt; 
0.137931 0.862069 0.000000 </code></pre>
</div>
</div>
</section><section id="class-4-9" class="level4"><h4 class="anchored" data-anchor-id="class-4-9">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   4   11    0 

        N         Y      &lt;NA&gt; 
0.2666667 0.7333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-6" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-6">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_thio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$use_thio
p-value = 0.02305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"CORTICOSTEROIDS.WITHIN.1st.YEAR...Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_cortico"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span>, <span class="st">"y"</span>, <span class="st">"Y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-10" class="level4"><h4 class="anchored" data-anchor-id="population-10">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  58  298    0 

        N         Y      &lt;NA&gt; 
0.1629213 0.8370787 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-10" class="level4"><h4 class="anchored" data-anchor-id="class-1-10">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  14   78    0 

        N         Y      &lt;NA&gt; 
0.1521739 0.8478261 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-10" class="level4"><h4 class="anchored" data-anchor-id="class-2-10">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  32  159    0 

        N         Y      &lt;NA&gt; 
0.1675393 0.8324607 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-10" class="level4"><h4 class="anchored" data-anchor-id="class-3-10">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb144"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10   48    0 

        N         Y      &lt;NA&gt; 
0.1724138 0.8275862 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-10" class="level4"><h4 class="anchored" data-anchor-id="class-4-10">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   2   13    0 

        N         Y      &lt;NA&gt; 
0.1333333 0.8666667 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-7" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-7">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$use_cortico
p-value = 0.9829
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-4-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"MTX.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_mtx"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-11" class="level4"><h4 class="anchored" data-anchor-id="population-11">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 341   15    0 

         N          Y       &lt;NA&gt; 
0.95786517 0.04213483 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-1-11" class="level4"><h4 class="anchored" data-anchor-id="class-1-11">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  84    8    0 

         N          Y       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-2-11" class="level4"><h4 class="anchored" data-anchor-id="class-2-11">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 185    6    0 

         N          Y       &lt;NA&gt; 
0.96858639 0.03141361 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-3-11" class="level4"><h4 class="anchored" data-anchor-id="class-3-11">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb157"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  57    1    0 

         N          Y       &lt;NA&gt; 
0.98275862 0.01724138 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-4-11" class="level4"><h4 class="anchored" data-anchor-id="class-4-11">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N &lt;NA&gt; 
  15    0 

   N &lt;NA&gt; 
   1    0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-8" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-8">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_mtx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$use_mtx
p-value = 0.1393
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"EEN..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"EEN"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span> <span class="op">&lt;-</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span>, <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-12" class="level4"><h4 class="anchored" data-anchor-id="population-12">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 213   80   63 

        N         Y      &lt;NA&gt; 
0.5983146 0.2247191 0.1769663 </code></pre>
</div>
</div>
</section><section id="class-1-12" class="level4"><h4 class="anchored" data-anchor-id="class-1-12">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  54   22   16 

        N         Y      &lt;NA&gt; 
0.5869565 0.2391304 0.1739130 </code></pre>
</div>
</div>
</section><section id="class-2-12" class="level4"><h4 class="anchored" data-anchor-id="class-2-12">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 115   39   37 

        N         Y      &lt;NA&gt; 
0.6020942 0.2041885 0.1937173 </code></pre>
</div>
</div>
</section><section id="class-3-12" class="level4"><h4 class="anchored" data-anchor-id="class-3-12">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb170"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  35   14    9 

        N         Y      &lt;NA&gt; 
0.6034483 0.2413793 0.1551724 </code></pre>
</div>
</div>
</section><section id="class-4-12" class="level4"><h4 class="anchored" data-anchor-id="class-4-12">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   9    5    1 

         N          Y       &lt;NA&gt; 
0.60000000 0.33333333 0.06666667 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-9" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-9">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$EEN
p-value = 0.7785
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.MONO...COMBO.WITHIN.3M"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-13" class="level4"><h4 class="anchored" data-anchor-id="population-13">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 312   44    0 

        0         1      &lt;NA&gt; 
0.8764045 0.1235955 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-13" class="level4"><h4 class="anchored" data-anchor-id="class-1-13">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  69   23    0 

   0    1 &lt;NA&gt; 
0.75 0.25 0.00 </code></pre>
</div>
</div>
</section><section id="class-2-13" class="level4"><h4 class="anchored" data-anchor-id="class-2-13">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 177   14    0 

         0          1       &lt;NA&gt; 
0.92670157 0.07329843 0.00000000 </code></pre>
</div>
</div>
</section><section id="class-3-13" class="level4"><h4 class="anchored" data-anchor-id="class-3-13">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb183"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  53    5    0 

        0         1      &lt;NA&gt; 
0.9137931 0.0862069 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-13" class="level4"><h4 class="anchored" data-anchor-id="class-4-13">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  13    2    0 

        0         1      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-10" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-10">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$use_bio3
p-value = 0.0005305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-14" class="level4"><h4 class="anchored" data-anchor-id="population-14">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 262   94    0 

        N         Y      &lt;NA&gt; 
0.7359551 0.2640449 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-1-14" class="level4"><h4 class="anchored" data-anchor-id="class-1-14">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  50   42    0 

        N         Y      &lt;NA&gt; 
0.5434783 0.4565217 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-2-14" class="level4"><h4 class="anchored" data-anchor-id="class-2-14">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 156   35    0 

        N         Y      &lt;NA&gt; 
0.8167539 0.1832461 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-3-14" class="level4"><h4 class="anchored" data-anchor-id="class-3-14">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  46   12    0 

        N         Y      &lt;NA&gt; 
0.7931034 0.2068966 0.0000000 </code></pre>
</div>
</div>
</section><section id="class-4-14" class="level4"><h4 class="anchored" data-anchor-id="class-4-14">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10    5    0 

        N         Y      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-11" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-11">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$class and demographic$use_bio
p-value = 1.823e-05
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-8" class="tab-pane" role="tabpanel" aria-labeledby="tabset-3-8-tab">
<p>Here, we consider the number of days from the start of the study period (2005-01-1) to when a subject was diagnosed to determine if when a subject was diagnosed has a statistically significant impact on which class a subject was assigned to.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu">datefixR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/datefixR/man/fix_dates.html">fix_dates</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="st">"DATE.OF.DIAGNOSIS"</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">Days.From.Start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">DATE.OF.DIAGNOSIS</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2005-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 356   2980 2280 3840   0 4710</code></pre>
</div>
</div>
<section id="class-1-15" class="level4"><h4 class="anchored" data-anchor-id="class-1-15">Class = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 92   3060 2480 4000 150 4700</code></pre>
</div>
</div>
</section><section id="class-2-15" class="level4"><h4 class="anchored" data-anchor-id="class-2-15">Class = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 191   3050 2110 3850   0 4710</code></pre>
</div>
</div>
</section><section id="class-3-15" class="level4"><h4 class="anchored" data-anchor-id="class-3-15">Class = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 58   2840 2260 3790 424 4410</code></pre>
</div>
</div>
</section><section id="class-4-15" class="level4"><h4 class="anchored" data-anchor-id="class-4-15">Class = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3  Min  Max
1 Days.From.Start 15   2820 2360 3430 1370 4300</code></pre>
</div>
</div>
</section><section id="anova-2" class="level4"><h4 class="anchored" data-anchor-id="anova-2">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Days.From.Start</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1   2713998 2713998   2.419  0.121
Residuals   354 397129240 1121834               </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="predictive-models" class="level2"><h2 class="anchored" data-anchor-id="predictive-models">Predictive models</h2>
<p>Here, we consider whether we can accurately predict class membership using age, sex, and the variables we found to be significantly associated with class membership: smoking at diagnosis, upper gastrointestinal inflammation (Montreal L4), and being prescribed a biologic therapeutic within one year of diagnosis. We consider two types of models: multinomial logistic regression models and a random forest classifiers using the <a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a> and <a href="https://github.com/imbs-hl/ranger">ranger</a> packages. We use the <a href="https://tidymodels.tidymodels.org">tidymodels</a> framework for fitting these models.</p>
<p>The data are split into a 75:25 train:test split and k-fold cross validation is used. Reported metrics and the confusion matrix are based on the test data split.</p>
<section id="all-classes" class="level3"><h3 class="anchored" data-anchor-id="all-classes">All classes</h3>
<p>Firstly, we attempt to predict class membership for all four classes.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class</span>, ref <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># </span></span>
<span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">demographic</span>, prop <span class="op">=</span> <span class="fl">0.75</span>, strata <span class="op">=</span> <span class="va">class</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">class</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio3</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="multinomial-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="multinomial-logistic-regression">Multinomial logistic regression</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mlr_mod</span> <span class="op">&lt;-</span> <span class="fu">multinom_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">mlr_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mlr_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span></span>
<span>                         <span class="fu">penalty</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">mlr_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_mlr</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_mlr</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">extract_fit_engine</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">call</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">nnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">class</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio3</span>,</span>
<span>                                  data <span class="op">=</span> <span class="va">train_data</span>,</span>
<span>                                  decay <span class="op">=</span> <span class="op">~</span><span class="fl">0.00316227766016838</span>, </span>
<span>                                  trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="odd-ratios" class="level5"><h5 class="anchored" data-anchor-id="odd-ratios">Odd ratios</h5>
<p>Point estimates:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">1.15</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">1.69</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">2.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.58</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">1.29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.02</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Lower 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Upper 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">4.29</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.68</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">4.07</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">3.71</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">2.81</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.81</td>
<td style="text-align: right;">5.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">2.86</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1.16</td>
<td style="text-align: right;">4.04</td>
<td style="text-align: right;">2.93</td>
<td style="text-align: right;">3.35</td>
<td style="text-align: right;">3.94</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">5.10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">3.13</td>
<td style="text-align: right;">2.12</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">4.35</td>
<td style="text-align: right;">7.18</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">6.57</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">1.87</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="metrics" class="level5"><h5 class="anchored" data-anchor-id="metrics">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb219"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.5555556</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6832527</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">class</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="random-forest" class="level4"><h4 class="anchored" data-anchor-id="random-forest">Random forest</h4>
<section id="metrics-1" class="level5"><h5 class="anchored" data-anchor-id="metrics-1">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb221"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                      trees <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span>,</span>
<span>             num.threads <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>             importance <span class="op">=</span> <span class="st">"permutation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="fu">trees</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tree_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_tree</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">extract_fit_parsnip</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/vip/man/vi.html">vi</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Importance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">use_bio</td>
<td style="text-align: right;">0.0078338</td>
</tr>
<tr class="even">
<td style="text-align: left;">use_bio3</td>
<td style="text-align: right;">0.0076051</td>
</tr>
<tr class="odd">
<td style="text-align: left;">L4</td>
<td style="text-align: right;">0.0054443</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoking</td>
<td style="text-align: right;">0.0027945</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOCATION</td>
<td style="text-align: right;">0.0015454</td>
</tr>
<tr class="even">
<td style="text-align: left;">DiagFC</td>
<td style="text-align: right;">0.0011091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">behaviour</td>
<td style="text-align: right;">0.0003897</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.0002174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">peri</td>
<td style="text-align: right;">-0.0004318</td>
</tr>
<tr class="even">
<td style="text-align: left;">SEX</td>
<td style="text-align: right;">-0.0005952</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.5555556</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6552993</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-1" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-1">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">class</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model performance for both the multinomial logistic regression model and the random forest classifier is very poor.</p>
</section></section></section><section id="class-2-16" class="level3"><h3 class="anchored" data-anchor-id="class-2-16">Class 2</h3>
<p>Due to the clinical significance of class 2 (see <a href="#outcomes">outcomes</a>), the clear separation in mean class profiles between class 2 and the other classes, and the poor model performance described above, we now consider binary outcome models which attempt to predict membership, or non-membership, of class 2.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb224"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">class2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">[</span><span class="va">demographic</span><span class="op">[</span>,<span class="st">"class"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span>, <span class="st">"class2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">demographic</span><span class="op">[</span><span class="va">demographic</span><span class="op">[</span>,<span class="st">"class"</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">2</span>, <span class="st">"class2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">class2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">class2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">demographic</span>, prop <span class="op">=</span> <span class="fl">0.75</span>, strata <span class="op">=</span> <span class="va">class2</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">class2</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                      <span class="va">FC.VALUE.AT.DIAGNOSIS</span> <span class="op">+</span> </span>
<span>                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio3</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="logistic-regression">Logistic regression</h4>
<p>As we now considering a binary outcome, logistic regression via the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function is used instead of multinomial logistic regression.</p>
<section id="metrics-2" class="level5"><h5 class="anchored" data-anchor-id="metrics-2">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lr_mod</span> <span class="op">&lt;-</span> <span class="fu">logistic_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">lr_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lr_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">penalty</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">lr_grid</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-stderr">
<pre><code>Warning: No tuning parameters have been detected, performance will be evaluated
using the resamples with no tuning. Did you want to [tune()] parameters?</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb227"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_lr</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_lr</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.6555556</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.6676587</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-2" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-2">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">class2</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">37</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="random-forest-1" class="level4"><h4 class="anchored" data-anchor-id="random-forest-1">Random forest</h4>
<section id="metrics-3" class="level5"><h5 class="anchored" data-anchor-id="metrics-3">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb229"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                      trees <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="fu">trees</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tree_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_tree</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_tree</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.5555556</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.5741567</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-3" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-3">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">class2</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">26</td>
<td style="text-align: right;">22</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, model performance remains very poor.</p>
</section></section></section></section><section id="session-information" class="level2"><h2 class="anchored" data-anchor-id="session-information">Session information</h2>
<div class="cell">
<div class="cell-output-display">
<p><strong>R version 4.2.0 (2022-04-22)</strong></p>
<p><strong>Platform:</strong> x86_64-apple-darwin17.0 (64-bit)</p>
<p><strong>locale:</strong> en_GB.UTF-8||en_GB.UTF-8||en_GB.UTF-8||C||en_GB.UTF-8||en_GB.UTF-8</p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>datasets</em>, <em>utils</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>plyr(v.1.8.7)</em>, <em>vip(v.0.3.2)</em>, <em>patchwork(v.1.1.1)</em>, <em>survminer(v.0.4.9)</em>, <em>ggpubr(v.0.4.0)</em>, <em>survival(v.3.3-1)</em>, <em>ranger(v.0.13.1)</em>, <em>yardstick(v.0.0.9)</em>, <em>workflowsets(v.0.2.1)</em>, <em>workflows(v.0.2.6)</em>, <em>tune(v.0.2.0)</em>, <em>tidyr(v.1.2.0)</em>, <em>tibble(v.3.1.7)</em>, <em>rsample(v.0.1.1)</em>, <em>recipes(v.0.2.0)</em>, <em>purrr(v.0.3.4)</em>, <em>parsnip(v.0.2.1)</em>, <em>modeldata(v.0.1.1)</em>, <em>infer(v.1.0.0)</em>, <em>ggplot2(v.3.3.6)</em>, <em>dplyr(v.1.0.9)</em>, <em>dials(v.0.1.1)</em>, <em>scales(v.1.2.0)</em>, <em>broom(v.0.8.0)</em>, <em>tidymodels(v.0.2.0)</em> and <em>nnet(v.7.3-17)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>colorspace(v.2.0-3)</em>, <em>ggsignif(v.0.6.3)</em>, <em>ellipsis(v.0.3.2)</em>, <em>class(v.7.3-20)</em>, <em>rstudioapi(v.0.13)</em>, <em>listenv(v.0.8.0)</em>, <em>furrr(v.0.3.0)</em>, <em>farver(v.2.1.0)</em>, <em>prodlim(v.2019.11.13)</em>, <em>fansi(v.1.0.3)</em>, <em>lubridate(v.1.8.0)</em>, <em>codetools(v.0.2-18)</em>, <em>splines(v.4.2.0)</em>, <em>knitr(v.1.39)</em>, <em>jsonlite(v.1.8.0)</em>, <em>pROC(v.1.18.0)</em>, <em>km.ci(v.0.5-6)</em>, <em>compiler(v.4.2.0)</em>, <em>backports(v.1.4.1)</em>, <em>assertthat(v.0.2.1)</em>, <em>Matrix(v.1.4-1)</em>, <em>fastmap(v.1.1.0)</em>, <em>cli(v.3.3.0)</em>, <em>htmltools(v.0.5.2)</em>, <em>tools(v.4.2.0)</em>, <em>gtable(v.0.3.0)</em>, <em>glue(v.1.6.2)</em>, <em>Rcpp(v.1.0.8.3)</em>, <em>carData(v.3.0-5)</em>, <em>DiceDesign(v.1.9)</em>, <em>vctrs(v.0.4.1)</em>, <em>iterators(v.1.0.14)</em>, <em>timeDate(v.3043.102)</em>, <em>gower(v.1.0.0)</em>, <em>xfun(v.0.30)</em>, <em>stringr(v.1.4.0)</em>, <em>globals(v.0.14.0)</em>, <em>lifecycle(v.1.0.1)</em>, <em>renv(v.0.15.5)</em>, <em>rstatix(v.0.7.0)</em>, <em>future(v.1.25.0)</em>, <em>MASS(v.7.3-57)</em>, <em>zoo(v.1.8-10)</em>, <em>ipred(v.0.9-12)</em>, <em>ragg(v.1.2.2)</em>, <em>parallel(v.4.2.0)</em>, <em>yaml(v.2.3.5)</em>, <em>gridExtra(v.2.3)</em>, <em>KMsurv(v.0.1-5)</em>, <em>pander(v.0.6.5)</em>, <em>rpart(v.4.1.16)</em>, <em>stringi(v.1.7.6)</em>, <em>highr(v.0.9)</em>, <em>foreach(v.1.5.2)</em>, <em>lhs(v.1.1.5)</em>, <em>hardhat(v.0.2.0)</em>, <em>lava(v.1.6.10)</em>, <em>systemfonts(v.1.0.4)</em>, <em>rlang(v.1.0.2)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>evaluate(v.0.15)</em>, <em>lattice(v.0.20-45)</em>, <em>datefixR(v.0.1.4)</em>, <em>htmlwidgets(v.1.5.4)</em>, <em>labeling(v.0.4.2)</em>, <em>tidyselect(v.1.1.2)</em>, <em>parallelly(v.1.31.1)</em>, <em>magrittr(v.2.0.3)</em>, <em>R6(v.2.5.1)</em>, <em>generics(v.0.1.2)</em>, <em>DBI(v.1.1.2)</em>, <em>pillar(v.1.7.0)</em>, <em>withr(v.2.5.0)</em>, <em>abind(v.1.4-5)</em>, <em>future.apply(v.1.9.0)</em>, <em>crayon(v.1.5.1)</em>, <em>car(v.3.0-13)</em>, <em>survMisc(v.0.5.6)</em>, <em>utf8(v.1.2.2)</em>, <em>rmarkdown(v.2.14)</em>, <em>grid(v.4.2.0)</em>, <em>data.table(v.1.14.2)</em>, <em>digest(v.0.6.29)</em>, <em>xtable(v.1.8-4)</em>, <em>textshaping(v.0.3.6)</em>, <em>GPfit(v.1.0-8)</em> and <em>munsell(v.0.5.0)</em></p>
</div>
</div>
</section><div id="quarto-appendix" class="default"><section id="section" class="level2 appendix"><h2 class="quarto-appendix-heading"></h2><div class="quarto-appendix-contents">
<p><img class="center" src="images/MRC_HGU_Edinburgh%20RGB.png" alt="MRC Human Genetics Unit logo" height="50px"><img src="images/cgem-logo.png" alt="Centre for Genomic &amp; Experimental Medicine logo" height="50px"></p>
</div></section><section id="acknowledgments" class="level2 appendix"><h2 class="quarto-appendix-heading">Acknowledgments</h2><div class="quarto-appendix-contents">
<p>This work is funded by the Medical Research Council &amp; University of Edinburgh via a Precision Medicine PhD studentship (MR/N013166/1, to <strong>NC-C</strong>)</p>
</div></section><section id="author-contributions" class="level2 appendix"><h2 class="quarto-appendix-heading">Author contributions</h2><div class="quarto-appendix-contents">
<p><strong>NC-C</strong> wrote the analysis. <strong>KM</strong> and <strong>CAV</strong> performed code review and contributed suggestions. <strong>RM</strong> contributed functions for calculating descriptive statistics. <strong>KM</strong>, <strong>RM</strong> and <strong>CAV</strong> provided feedback.</p>
</div></section><section id="reuse" class="level2 appendix"><h2 class="quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents">
<p>Licensed by <a href="https://creativecommons.org/licenses/by/4.0/">CC BY </a> unless otherwise stated.</p>




</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Peto1972" class="csl-entry" role="doc-biblioentry">
Peto, Richard, and Julian Peto. 1972. <span>“Asymptotically Efficient Rank Invariant Test Procedures.”</span> <em>Journal of the Royal Statistical Society. Series A (General)</em> 135 (2): 185. <a href="https://doi.org/10.2307/2344317">https://doi.org/10.2307/2344317</a>.
</div>
</div></section></div></main><!-- /main --><script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/IBDNathan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>