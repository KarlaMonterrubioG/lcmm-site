<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nathan Contantine-Cooke">
<meta name="author" content="Karla Monterrubio-Gómez">
<meta name="author" content="Riccardo E. Marioni">
<meta name="author" content="Catalina A. Vallejos">
<meta name="dcterms.date" content="2023-11-24">
<title>Analysis by Constantine-Cooke et al.&nbsp;- Association Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<link rel="stylesheet" href="theme.css">
<meta property="og:title" content="Analysis by Constantine-Cooke et al.&nbsp;- Association Testing">
<meta property="og:description" content="Comparing demographic data, clinical data, and outcomes across clusters.">
<meta property="og:site-name" content="Analysis by Constantine-Cooke et al.">
<meta name="twitter:title" content="Analysis by Constantine-Cooke et al.&nbsp;- Association Testing">
<meta name="twitter:description" content="Comparing demographic data, clinical data, and outcomes across clusters.">
<meta name="twitter:creator" content="@nathansam">
<meta name="twitter:site" content="@EdinUni_IGC">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="Longitudinal Fecal Calprotectin Profiles Characterize Disease Course Heterogeneity in Crohn’s Disease">
<meta name="citation_author" content="Nathan Constantine-Cooke">
<meta name="citation_author" content="Karla Monterrubio-Gómez">
<meta name="citation_author" content="Nikolas Plevris">
<meta name="citation_author" content="Lauranne A.A.P. Derikx">
<meta name="citation_author" content="Beatriz Gros">
<meta name="citation_author" content="Gareth-Rhys Jones">
<meta name="citation_author" content="Riccardo E. Marioni">
<meta name="citation_author" content="Charlie W. Lees">
<meta name="citation_author" content="Catalina A. Vallejos">
<meta name="citation_publication_date" content="2023-11-24">
<meta name="citation_cover_date" content="2023-11-24">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2023-11-24">
<meta name="citation_fulltext_html_url" content="https://www.cghjournal.org/article/S1542-3565(23)00234-3/">
<meta name="citation_doi" content="10.1016/j.cgh.2023.03.026">
<meta name="citation_issn" content="1542-3565">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Clinical Gastroenterology and Hepatology">
<meta name="citation_publisher" content="Elsevier">
<meta name="citation_reference" content="citation_title=Normalization of fecal calprotectin within 12 months of diagnosis is associated with reduced risk of disease progression in patients with Crohn’s disease;,citation_author=Nikolas Plevris;,citation_author=James Fulforth;,citation_author=Mathew Lyons;,citation_author=Spyros I. Siakavellas;,citation_author=Philip W. Jenkinson;,citation_author=Cher S. Chuah;,citation_author=Laura Lucaciu;,citation_author=Rebecca J. Pattenden;,citation_author=Ian D. Arnott;,citation_author=Gareth-Rhys Jones;,citation_author=Charlie W. Lees;,citation_publication_date=2021-09;,citation_cover_date=2021-09;,citation_year=2021;,citation_issue=9;,citation_doi=10.1016/j.cgh.2020.08.022;,citation_volume=19;,citation_journal_title=Clinical Gastroenterology and Hepatology;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Clinical course in crohns disease: Results of a five-year population-based follow-up study (the IBSEN study);,citation_author=Magne Henriksen;,citation_author=Jørgen Jahnsen;,citation_author=Idar Lygren;,citation_author=Erling Aadland;,citation_author=Tom Schulz;,citation_author=Morten H. Vatn;,citation_author=Bjørn Moum;,citation_author=THE IBSEN STUDY GROUP;,citation_publication_date=2007-01;,citation_cover_date=2007-01;,citation_year=2007;,citation_fulltext_html_url=https://doi.org/10.1080%2F00365520601076124;,citation_issue=5;,citation_doi=10.1080/00365520601076124;,citation_volume=42;,citation_journal_title=Scandinavian Journal of Gastroenterology;,citation_publisher=Informa UK Limited;">
<meta name="citation_reference" content="citation_title=Polynomials and potential theory for gaussian radial basis function interpolation;,citation_abstract=We explore a connection between Gaussian radial basis functions and polynomials. Using standard tools of potential theory, we find that these radial functions are susceptible to the Runge phenomenon, not only in the limit of increasingly flat functions, but also in the finite shape parameter case. We show that there exist interpolation node distributions that prevent such phenomena and allow stable approximations. Using polynomials also provides an explicitinterpolation formula that avoids the difficulties of inverting interpolation matrices, while not imposing restrictions on the shape parameter or number of points.;,citation_author=Rodrigo B. Platte;,citation_author=Tobin A. Driscoll;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_fulltext_html_url=https://doi.org/10.1137/040610143;,citation_issue=2;,citation_doi=10.1137/040610143;,citation_volume=43;,citation_journal_title=SIAM Journal on Numerical Analysis;">
<meta name="citation_reference" content="citation_title=Estimation of extended mixed models using latent classes and latent processes: The R package lcmm;,citation_author=Cécile Proust-Lima;,citation_author=Viviane Philipps;,citation_author=Benoit Liquet;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=2;,citation_doi=10.18637/jss.v078.i02;,citation_volume=78;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Regression modeling strategies;,citation_author=undefined Frank E. Harrell;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_doi=10.1007/978-3-319-19425-7;">
<meta name="citation_reference" content="citation_title=The runge phenomenon and spatially variable shape parameters in RBF interpolation;,citation_abstract=Many studies, mostly empirical, have been devoted to finding an optimal shape parameter for radial basis functions (RBF). When exploring the underlying factors that determine what is a good such choice, we are led to consider the Runge phenomenon (RP; best known in cases of high order polynomial interpolation) as a key error mechanism. This observation suggests that it can be advantageous to let the shape parameter vary spatially, rather than assigning a single value to it. Benefits typically include improvements in both accuracy and numerical conditioning. Still another benefit arises if one wishes to improve local accuracy by clustering nodes in selected areas. This idea is routinely used when working with splines or finite element methods. However, local refinement with RBFs may cause RP-type errors unless we use a spatially variable shape paremeter. With this enhancement, RBF approximations combine freedom from meshes with spectral accuracy on irregular domains, and furthermore permit local node clustering to improve the resolution wherever this might be needed.;,citation_author=Bengt Fornberg;,citation_author=Julia Zuev;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0898122107002210;,citation_issue=3;,citation_doi=https://doi.org/10.1016/j.camwa.2007.01.028;,citation_issn=0898-1221;,citation_volume=54;,citation_journal_title=Computers &amp;amp;amp; Mathematics with Applications;">
<meta name="citation_reference" content="citation_title=Using linear and natural cubic splines, SITAR, and latent trajectory models to characterise nonlinear longitudinal growth trajectories in cohort studies;,citation_abstract=Longitudinal data analysis can improve our understanding of the influences on health trajectories across the life-course. There are a variety of statistical models which can be used, and their fitting and interpretation can be complex, particularly where there is a nonlinear trajectory. Our aim was to provide an accessible guide along with applied examples to using four sophisticated modelling procedures for describing nonlinear growth trajectories.;,citation_author=Ahmed Elhakeem;,citation_author=Rachael A. Hughes;,citation_author=Kate Tilling;,citation_author=Diana L. Cousminer;,citation_author=Stefan A. Jackowski;,citation_author=Tim J. Cole;,citation_author=Alex S. F. Kwong;,citation_author=Zheyuan Li;,citation_author=Struan F. A. Grant;,citation_author=Adam D. G. Baxter-Jones;,citation_author=Babette S. Zemel;,citation_author=Deborah A. Lawlor;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1186/s12874-022-01542-8;,citation_issue=1;,citation_doi=10.1186/s12874-022-01542-8;,citation_isbn=1471-2288;,citation_volume=22;,citation_journal_title=BMC Medical Research Methodology;">
<meta name="citation_reference" content="citation_title=Asymptotically efficient rank invariant test procedures;,citation_author=Richard Peto;,citation_author=Julian Peto;,citation_publication_date=1972;,citation_cover_date=1972;,citation_year=1972;,citation_issue=2;,citation_doi=10.2307/2344317;,citation_volume=135;,citation_journal_title=Journal of the Royal Statistical Society. Series A (General);,citation_publisher=JSTOR;">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analysis by Constantine-Cooke et al.</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-cleaning.html">
 <span class="menu-text">Data Cleaning</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./selection.html">
 <span class="menu-text">Model Selection</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./associations.html" aria-current="page">
 <span class="menu-text">Association Testing</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vallejosgroup/lcmm-site"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://vallejosgroup.github.io"><i class="bi bi-person-rolodex" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#characteristics-available-at-diagnosis" id="toc-characteristics-available-at-diagnosis" class="nav-link" data-scroll-target="#characteristics-available-at-diagnosis">Characteristics available at diagnosis</a></li>
  <li><a href="#associations-with-treatment-information" id="toc-associations-with-treatment-information" class="nav-link" data-scroll-target="#associations-with-treatment-information">Associations with treatment information</a></li>
  <li>
<a href="#predictive-models" id="toc-predictive-models" class="nav-link" data-scroll-target="#predictive-models">Predictive models</a>
  <ul class="collapse">
<li><a href="#multinomial-logistic-regression" id="toc-multinomial-logistic-regression" class="nav-link" data-scroll-target="#multinomial-logistic-regression">Multinomial logistic regression</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">Random forest</a></li>
  </ul>
</li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information">Session information</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
  <li><a href="#author-contributions" id="toc-author-contributions" class="nav-link" data-scroll-target="#author-contributions">Author contributions</a></li>
  <li><a href="#reuse" id="toc-reuse" class="nav-link" data-scroll-target="#reuse">Reuse</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/vallejosgroup/lcmm-site/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Association Testing</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/vallejosgroup/lcmm-site/blob/main/associations.qmd">View Source</a></li></ul></div></div>
<p class="subtitle lead">Comparing demographic data, clinical data, and outcomes across clusters.</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=2emHWR0AAAAJ&amp;hl=en&amp;oi=ao">Nathan Contantine-Cooke</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/centre-genomic-medicine">
            Centre for Genomic and Experimental Medicine
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=YmyxSXAAAAAJ&amp;hl=en">Karla Monterrubio-Gómez</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?hl=en&amp;user=gA3Ik3MAAAAJ">Riccardo E. Marioni</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/centre-genomic-medicine">
            Centre for Genomic and Experimental Medicine
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=lkdrwm0AAAAJ&amp;hl=en&amp;oi=ao">Catalina A. Vallejos</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
        <p class="affiliation">
            <a href="https://www.turing.ac.uk">
            The Alan Turing Institute
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span> <span class="co"># Multinomial logistic regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span> <span class="co"># Modelling framework</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://imbs-hl.github.io/ranger/">ranger</a></span><span class="op">)</span> <span class="co"># Random forest</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span> <span class="co"># Kaplan-Meier</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html">survminer</a></span><span class="op">)</span> <span class="co"># Plot Kaplan-Meier curves</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/koalaverse/vip/">vip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">KONPsurv</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"plyr"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">########################</span></span>
<span><span class="co">#-- Custom Functions --#</span></span>
<span><span class="co">########################</span></span>
<span></span>
<span><span class="co">#' @title Calculate descriptive statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @param vars Character vector of continuous variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Finds the median, first quartile, third quartile, minimum and maximum</span></span>
<span><span class="co">#'   statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 7 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cont</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">out_desc</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">med</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#' @title Calculate descriptive statistics for categorical variables</span></span>
<span><span class="co">#' @param vars Character vector of categorical variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Prints frequency and proportional tables for given categorical variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 3 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">kaplan_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">title</span>, <span class="va">subtitle</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">legend</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">legend</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subtitle</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span>, <span class="st">"Stratified by cluster"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After <a href="./selection.html">deeming the four-cluster LCMM to be the most suitable</a>, we will now explore potential associations with cluster membership. We will consider variables typically available at diagnosis, outcomes usually indicative of a poor disease course, and treatments prescribed within one year of diagnosis. For all categorical variables, frequency tables for the study population and clusters have been generated in addition to either chi-squared test or (if a cell has &lt; 5 observations) Fisher’s exact test results. For continuous variables, the median, first quartile, and third quartile have been reported for the study population and clusters in addition to ANOVA results.</p>
<p>To streamline the analysis, descriptive functions have been created, <code>describe_cat()</code> and <code>describe_cont()</code> which generate the aforementioned results</p>
<p>We also attempt to predict cluster membership based on these variables to determine if cluster membership can be accurately predicted ahead of time using these variables. We consider both multinomial logistic regression and random forest predictive models for this purpose.</p>
</section><section id="characteristics-available-at-diagnosis" class="level2"><h2 class="anchored" data-anchor-id="characteristics-available-at-diagnosis">Characteristics available at diagnosis</h2>
<p>We have found two variables available at diagnosis to be associated with cluster membership: smoking at diagnosis (<span class="math inline">p = 0.015</span>) and upper gastrointestinal inflammation (Montreal L4; <span class="math inline">p &lt; 0.001</span>).</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/cdi/processed/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"cache/cubicbf.fits.RDS"</span><span class="op">)</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                                     from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                     to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/cdi/data/"</span>,</span>
<span>                               <span class="st">"20220328/"</span>,</span>
<span>                               <span class="st">"Nathan_FCprogressioncohort.csv"</span><span class="op">)</span></span>
<span>                         <span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">Number</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"id"</span></span>
<span><span class="va">classes</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">classes</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">demographic</span><span class="op">$</span><span class="va">class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Sex</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Age at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Smoking at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Diagnostic FCAL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Montreal behaviour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">Perianal</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">Montreal location</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">Upper GI</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="population" class="level4"><h4 class="anchored" data-anchor-id="population">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
 173  183    0 

        F         M      &lt;NA&gt; 
0.4859551 0.5140449 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-1">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  49   43    0 

        F         M      &lt;NA&gt; 
0.5326087 0.4673913 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-2">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  84  107    0 

        F         M      &lt;NA&gt; 
0.4397906 0.5602094 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-3">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  34   24    0 

        F         M      &lt;NA&gt; 
0.5862069 0.4137931 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-4">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
   6    9    0 

   F    M &lt;NA&gt; 
 0.4  0.6  0.0 </code></pre>
</div>
</div>
</section><section id="chi-squared-test" class="level4"><h4 class="anchored" data-anchor-id="chi-squared-test">Chi-squared test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">SEX</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  demographic$SEX and demographic$cluster
X-squared = 5.2083, df = 3, p-value = 0.1572</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="population-1" class="level4"><h4 class="anchored" data-anchor-id="population-1">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median Q1   Q3  Min  Max
1      age 356   27.3 16 48.7 3.75 87.1</code></pre>
</div>
</div>
</section><section id="cluster-1-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-1">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 92   29.6 20.4 45.3 6.87 87.1</code></pre>
</div>
</div>
</section><section id="cluster-2-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-1">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median   Q1   Q3  Min  Max
1      age 191   26.4 15.3 49.9 3.75 81.3</code></pre>
</div>
</div>
</section><section id="cluster-3-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-1">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 58   26.8 15.1 50.9 4.98 78.4</code></pre>
</div>
</div>
</section><section id="cluster-4-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-1">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 15   21.7 14.5 51.2 10.5 71.3</code></pre>
</div>
</div>
</section><section id="anova" class="level4"><h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
class         1     14    14.5   0.036  0.851
Residuals   354 144163   407.2               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>If a participant has reported to have not smoked in the past, then it is assumed the participant did not smoke at IBD diagnosis. Otherwise smoking status is taken from the participant’s response to being asked if they were smoking when diagnosed with IBD.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"SMOKER..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"smoking"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-2" class="level4"><h4 class="anchored" data-anchor-id="population-2">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 286   70    0 

       no       yes      &lt;NA&gt; 
0.8033708 0.1966292 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-2">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  70   22    0 

       no       yes      &lt;NA&gt; 
0.7608696 0.2391304 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-2">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 148   43    0 

       no       yes      &lt;NA&gt; 
0.7748691 0.2251309 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-2">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  54    4    0 

        no        yes       &lt;NA&gt; 
0.93103448 0.06896552 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-2">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  14    1    0 

        no        yes       &lt;NA&gt; 
0.93333333 0.06666667 0.00000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$smoking
p-value = 0.01455
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<section id="population-3" class="level4"><h4 class="anchored" data-anchor-id="population-3">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/processed-data/cdi/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="va">FCcumulative</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">FCcumulative</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span></span>
<span>  <span class="va">subject.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">DiagFC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">subject.data</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"value"</span><span class="op">]</span> <span class="co"># Already sorted by time</span></span>
<span><span class="op">}</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="va">DiagFC</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 356    820 590 1140 250 2500</code></pre>
</div>
</div>
</section><section id="cluster-1-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-3">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1  Q3 Min  Max
1   DiagFC 92    725 500 986 253 2500</code></pre>
</div>
</div>
</section><section id="cluster-2-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-3">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 191    900 610 1270 250 2500</code></pre>
</div>
</div>
</section><section id="cluster-3-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-3">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 58    825 592 1180 310 2500</code></pre>
</div>
</div>
</section><section id="cluster-4-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-3">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 15    660 630 1160 470 2040</code></pre>
</div>
</div>
</section><section id="anova-1" class="level4"><h4 class="anchored" data-anchor-id="anova-1">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DiagFC</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1    676441  676441   2.295  0.131
Residuals   354 104332274  294724               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BEHAVIOUR.AT.DIAGNOSIS"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"behaviour"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-4" class="level4"><h4 class="anchored" data-anchor-id="population-4">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 323   30    3    0 

          1           2           3        &lt;NA&gt; 
0.907303371 0.084269663 0.008426966 0.000000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-4">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  80   10    2    0 

         1          2          3       &lt;NA&gt; 
0.86956522 0.10869565 0.02173913 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-4">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 175   15    1    0 

          1           2           3        &lt;NA&gt; 
0.916230366 0.078534031 0.005235602 0.000000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-4">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  55    3    0    0 

         1          2          3       &lt;NA&gt; 
0.94827586 0.05172414 0.00000000 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-4">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  13    2    0    0 

        1         2         3      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-1" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-1">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$behaviour
p-value = 0.4937
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"PERIANAL.DISEASE..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"peri"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-5" class="level4"><h4 class="anchored" data-anchor-id="population-5">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 299   57    0 

       no       yes      &lt;NA&gt; 
0.8398876 0.1601124 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-5">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  75   17    0 

       no       yes      &lt;NA&gt; 
0.8152174 0.1847826 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-5">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 163   28    0 

       no       yes      &lt;NA&gt; 
0.8534031 0.1465969 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-5">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  49    9    0 

       no       yes      &lt;NA&gt; 
0.8448276 0.1551724 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-5">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  12    3    0 

  no  yes &lt;NA&gt; 
 0.8  0.2  0.0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-2" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-2">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">peri</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$peri
p-value = 0.7757
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span>, <span class="st">"L3"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-6" class="level4"><h4 class="anchored" data-anchor-id="population-6">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  95  140  121    0 

       L1        L2        L3      &lt;NA&gt; 
0.2668539 0.3932584 0.3398876 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-6">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  22   39   31    0 

       L1        L2        L3      &lt;NA&gt; 
0.2391304 0.4239130 0.3369565 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-6">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  58   68   65    0 

       L1        L2        L3      &lt;NA&gt; 
0.3036649 0.3560209 0.3403141 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-6">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   9   30   19    0 

       L1        L2        L3      &lt;NA&gt; 
0.1551724 0.5172414 0.3275862 0.0000000 </code></pre>
</div>
</div>
<section id="cluster-4-6" class="level5"><h5 class="anchored" data-anchor-id="cluster-4-6">Cluster = 4</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   6    3    6    0 

  L1   L2   L3 &lt;NA&gt; 
 0.4  0.2  0.4  0.0 </code></pre>
</div>
</div>
</section></section><section id="fishers-exact-test-3" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-3">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, workspace <span class="op">=</span> <span class="fl">800000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$LOCATION
p-value = 0.125
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"L4.Modifier"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"L4"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-7" class="level4"><h4 class="anchored" data-anchor-id="population-7">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 272   84    0 

       no       yes      &lt;NA&gt; 
0.7640449 0.2359551 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-7">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  84    8    0 

        no        yes       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-7">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 140   51    0 

       no       yes      &lt;NA&gt; 
0.7329843 0.2670157 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-7">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  38   20    0 

       no       yes      &lt;NA&gt; 
0.6551724 0.3448276 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-7">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  10    5    0 

       no       yes      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-4" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-4">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">L4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$L4
p-value = 0.0002175
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="associations-with-treatment-information" class="level2"><h2 class="anchored" data-anchor-id="associations-with-treatment-information">Associations with treatment information</h2>
<p>To explore the potential presence of treatment effects, we have tested for associations between cluster membership and common IBD prescriptions. All treatments were prescribed within one year of diagnosis unless otherwise stated. Thioprine use (<span class="math inline">p = 0.02</span>), biologic use within three months of diagnosis (<span class="math inline">p &lt; 0.001</span>), and biologic use within one year of diagnosis (<span class="math inline">p &lt; 0.001</span>) were found to be significantly associated with cluster membership.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">5ASA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Thioprine</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Corticosteroids</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Methotrexate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">EEN</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Biologic use within three months</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Biologic use within one year</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Date of diagnosis</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<section id="population-8" class="level4"><h4 class="anchored" data-anchor-id="population-8">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb104"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 280   76    0 

        N         Y      &lt;NA&gt; 
0.7865169 0.2134831 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-8">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb106"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  77   15    0 

        N         Y      &lt;NA&gt; 
0.8369565 0.1630435 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-8">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 143   48    0 

        N         Y      &lt;NA&gt; 
0.7486911 0.2513089 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-8">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  47   11    0 

        N         Y      &lt;NA&gt; 
0.8103448 0.1896552 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-8">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  13    2    0 

        N         Y      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-5" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-5">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">X5ASA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$X5ASA
p-value = 0.3261
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"THIOPURINE.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_thio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-9" class="level4"><h4 class="anchored" data-anchor-id="population-9">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb117"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 106  250    0 

        N         Y      &lt;NA&gt; 
0.2977528 0.7022472 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-9">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb119"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  30   62    0 

       N        Y     &lt;NA&gt; 
0.326087 0.673913 0.000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-9">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb121"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  64  127    0 

        N         Y      &lt;NA&gt; 
0.3350785 0.6649215 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-9">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb123"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   8   50    0 

       N        Y     &lt;NA&gt; 
0.137931 0.862069 0.000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-9">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb125"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   4   11    0 

        N         Y      &lt;NA&gt; 
0.2666667 0.7333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-6" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-6">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb127"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_thio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_thio
p-value = 0.02305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb129"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"CORTICOSTEROIDS.WITHIN.1st.YEAR...Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_cortico"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span>, <span class="st">"y"</span>, <span class="st">"Y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-10" class="level4"><h4 class="anchored" data-anchor-id="population-10">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  58  298    0 

        N         Y      &lt;NA&gt; 
0.1629213 0.8370787 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-10">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  14   78    0 

        N         Y      &lt;NA&gt; 
0.1521739 0.8478261 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-10">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb134"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  32  159    0 

        N         Y      &lt;NA&gt; 
0.1675393 0.8324607 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-10">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb136"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10   48    0 

        N         Y      &lt;NA&gt; 
0.1724138 0.8275862 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-10">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb138"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   2   13    0 

        N         Y      &lt;NA&gt; 
0.1333333 0.8666667 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-7" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-7">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb140"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_cortico
p-value = 0.9829
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb142"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"MTX.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_mtx"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-11" class="level4"><h4 class="anchored" data-anchor-id="population-11">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 341   15    0 

         N          Y       &lt;NA&gt; 
0.95786517 0.04213483 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-11">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  84    8    0 

         N          Y       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-11">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb147"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 185    6    0 

         N          Y       &lt;NA&gt; 
0.96858639 0.03141361 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-11">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb149"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  57    1    0 

         N          Y       &lt;NA&gt; 
0.98275862 0.01724138 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-11">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb151"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N &lt;NA&gt; 
  15    0 

   N &lt;NA&gt; 
   1    0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-8" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-8">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb153"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_mtx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_mtx
p-value = 0.1393
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb155"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"EEN..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"EEN"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span> <span class="op">&lt;-</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span>, <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-12" class="level4"><h4 class="anchored" data-anchor-id="population-12">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 213   80   63 

        N         Y      &lt;NA&gt; 
0.5983146 0.2247191 0.1769663 </code></pre>
</div>
</div>
</section><section id="cluster-1-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-12">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  54   22   16 

        N         Y      &lt;NA&gt; 
0.5869565 0.2391304 0.1739130 </code></pre>
</div>
</div>
</section><section id="cluster-2-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-12">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb160"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 115   39   37 

        N         Y      &lt;NA&gt; 
0.6020942 0.2041885 0.1937173 </code></pre>
</div>
</div>
</section><section id="cluster-3-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-12">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb162"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  35   14    9 

        N         Y      &lt;NA&gt; 
0.6034483 0.2413793 0.1551724 </code></pre>
</div>
</div>
</section><section id="cluster-4-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-12">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb164"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   9    5    1 

         N          Y       &lt;NA&gt; 
0.60000000 0.33333333 0.06666667 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-9" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-9">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb166"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$EEN
p-value = 0.7785
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb168"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.MONO...COMBO.WITHIN.3M"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-13" class="level4"><h4 class="anchored" data-anchor-id="population-13">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 312   44    0 

        0         1      &lt;NA&gt; 
0.8764045 0.1235955 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-13">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  69   23    0 

   0    1 &lt;NA&gt; 
0.75 0.25 0.00 </code></pre>
</div>
</div>
</section><section id="cluster-2-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-13">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb173"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 177   14    0 

         0          1       &lt;NA&gt; 
0.92670157 0.07329843 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-13">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb175"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  53    5    0 

        0         1      &lt;NA&gt; 
0.9137931 0.0862069 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-13">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb177"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  13    2    0 

        0         1      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-10" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-10">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb179"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_bio3
p-value = 0.0005305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb181"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-14" class="level4"><h4 class="anchored" data-anchor-id="population-14">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 262   94    0 

        N         Y      &lt;NA&gt; 
0.7359551 0.2640449 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-14">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  50   42    0 

        N         Y      &lt;NA&gt; 
0.5434783 0.4565217 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-14">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb186"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 156   35    0 

        N         Y      &lt;NA&gt; 
0.8167539 0.1832461 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-14">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb188"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  46   12    0 

        N         Y      &lt;NA&gt; 
0.7931034 0.2068966 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-14">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb190"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10    5    0 

        N         Y      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-11" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-11">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb192"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_bio
p-value = 1.823e-05
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<p>Here, we consider the number of days from the start of the study period (2005-01-1) to when a subject was diagnosed to determine if when a subject was diagnosed has a statistically significant impact on which cluster a subject was assigned to.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb194"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu">datefixR</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/datefixR/reference/fix_dates.html">fix_dates</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="st">"DATE.OF.DIAGNOSIS"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: `fix_dates()` was deprecated in datefixR 1.0.0.
ℹ Please use `fix_date_df()` instead.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb196"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">Days.From.Start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">DATE.OF.DIAGNOSIS</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2005-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 356   2980 2280 3840   0 4710</code></pre>
</div>
</div>
<section id="cluster-1-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-15">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 92   3060 2480 4000 150 4700</code></pre>
</div>
</div>
</section><section id="cluster-2-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-15">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 191   3050 2110 3850   0 4710</code></pre>
</div>
</div>
</section><section id="cluster-3-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-15">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 58   2840 2260 3790 424 4410</code></pre>
</div>
</div>
</section><section id="cluster-4-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-15">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3  Min  Max
1 Days.From.Start 15   2820 2360 3430 1370 4300</code></pre>
</div>
</div>
</section><section id="anova-2" class="level4"><h4 class="anchored" data-anchor-id="anova-2">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Days.From.Start</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1   2713998 2713998   2.419  0.121
Residuals   354 397129240 1121834               </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="predictive-models" class="level2"><h2 class="anchored" data-anchor-id="predictive-models">Predictive models</h2>
<p>Here, we consider whether we can accurately predict cluster membership using age, sex, and the variables we found to be significantly associated with cluster membership: smoking at diagnosis, upper gastrointestinal inflammation (Montreal L4), and being prescribed a biologic therapeutic within one year of diagnosis. We consider two types of models: multinomial logistic regression models and a random forest classifiers using the <a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a> and <a href="http://imbs-hl.github.io/ranger/">ranger</a> packages. We use the <a href="https://tidymodels.tidymodels.org">tidymodels</a> framework for fitting these models.</p>
<p>The data are split into a 75:25 train:test split and k-fold cross validation is used. Reported metrics and the confusion matrix are based on the test data split.</p>
<p>We attempt to predict cluster membership for all four clusters.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, ref <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># </span></span>
<span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">demographic</span>, prop <span class="op">=</span> <span class="fl">0.75</span>, strata <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">4</span>, strata <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">cluster</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio3</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="multinomial-logistic-regression" class="level3"><h3 class="anchored" data-anchor-id="multinomial-logistic-regression">Multinomial logistic regression</h3>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb209"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mlr_mod</span> <span class="op">&lt;-</span> <span class="fu">multinom_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">mlr_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mlr_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span></span>
<span>                         <span class="fu">penalty</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">mlr_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_mlr</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_mlr</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">extract_fit_engine</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">call</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">nnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">cluster</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio3</span>,</span>
<span>                                  data <span class="op">=</span> <span class="va">train_data</span>,</span>
<span>                                  decay <span class="op">=</span> <span class="op">~</span><span class="fl">0.00316227766016838</span>, </span>
<span>                                  trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="odd-ratios" class="level4"><h4 class="anchored" data-anchor-id="odd-ratios">Odd ratios</h4>
<p>Point estimates:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">544306.31</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: right;">2.82</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">2.05</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.25</td>
<td style="text-align: right;">1.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.22</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.38</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">2.24</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.31</td>
<td style="text-align: right;">1.05</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Lower 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb211"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">544306.03</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">0.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.57</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.52</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Upper 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">3.60</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.71</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">5.06</td>
<td style="text-align: right;">6.14</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">4.49</td>
<td style="text-align: right;">544306.58</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5.54</td>
<td style="text-align: right;">8.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">5.53</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">3.74</td>
<td style="text-align: right;">4.42</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.39</td>
<td style="text-align: right;">6.69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">3.98</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">6.24</td>
<td style="text-align: right;">7.87</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">10.35</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.93</td>
<td style="text-align: right;">2.14</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="metrics" class="level4"><h4 class="anchored" data-anchor-id="metrics">Metrics</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb213"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.5111111</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6591539</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix" class="level4"><h4 class="anchored" data-anchor-id="confusion-matrix">Confusion matrix</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="random-forest" class="level3"><h3 class="anchored" data-anchor-id="random-forest">Random forest</h3>
<section id="metrics-1" class="level4"><h4 class="anchored" data-anchor-id="metrics-1">Metrics</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb215"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                      trees <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span>,</span>
<span>             num.threads <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>             importance <span class="op">=</span> <span class="st">"permutation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="fu">trees</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tree_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_tree</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">extract_fit_parsnip</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://koalaverse.github.io/vip/reference/vi.html">vi</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Importance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">use_bio</td>
<td style="text-align: right;">0.0086542</td>
</tr>
<tr class="even">
<td style="text-align: left;">use_bio3</td>
<td style="text-align: right;">0.0084335</td>
</tr>
<tr class="odd">
<td style="text-align: left;">L4</td>
<td style="text-align: right;">0.0051902</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoking</td>
<td style="text-align: right;">0.0031569</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOCATION</td>
<td style="text-align: right;">0.0021937</td>
</tr>
<tr class="even">
<td style="text-align: left;">DiagFC</td>
<td style="text-align: right;">0.0016417</td>
</tr>
<tr class="odd">
<td style="text-align: left;">behaviour</td>
<td style="text-align: right;">0.0003184</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.0000993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">peri</td>
<td style="text-align: right;">-0.0006497</td>
</tr>
<tr class="even">
<td style="text-align: left;">SEX</td>
<td style="text-align: right;">-0.0010218</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.5666667</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6458333</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-1" class="level4"><h4 class="anchored" data-anchor-id="confusion-matrix-1">Confusion matrix</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb217"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model performance for both the multinomial logistic regression model and the random forest classifier is very poor.</p>
</section></section></section><section id="session-information" class="level2"><h2 class="anchored" data-anchor-id="session-information">Session information</h2>
<div class="cell">
<div class="cell-output-display">
<p><strong>R version 4.3.2 (2023-10-31)</strong></p>
<p><strong>Platform:</strong> aarch64-apple-darwin20 (64-bit)</p>
<p><strong>locale:</strong> en_GB.UTF-8||en_GB.UTF-8||en_GB.UTF-8||C||en_GB.UTF-8||en_GB.UTF-8</p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>plyr(v.1.8.9)</em>, <em>KONPsurv(v.1.0.4)</em>, <em>vip(v.0.4.1)</em>, <em>patchwork(v.1.1.3)</em>, <em>survminer(v.0.4.9)</em>, <em>ggpubr(v.0.6.0)</em>, <em>survival(v.3.5-7)</em>, <em>ranger(v.0.16.0)</em>, <em>yardstick(v.1.2.0)</em>, <em>workflowsets(v.1.0.1)</em>, <em>workflows(v.1.1.3)</em>, <em>tune(v.1.1.2)</em>, <em>tidyr(v.1.3.0)</em>, <em>tibble(v.3.2.1)</em>, <em>rsample(v.1.2.0)</em>, <em>recipes(v.1.0.8)</em>, <em>purrr(v.1.0.2)</em>, <em>parsnip(v.1.1.1)</em>, <em>modeldata(v.1.2.0)</em>, <em>infer(v.1.0.5)</em>, <em>ggplot2(v.3.4.4)</em>, <em>dplyr(v.1.1.4)</em>, <em>dials(v.1.2.0)</em>, <em>scales(v.1.2.1)</em>, <em>broom(v.1.0.5)</em>, <em>tidymodels(v.1.1.1)</em> and <em>nnet(v.7.3-19)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>gridExtra(v.2.3)</em>, <em>httr2(v.1.0.0)</em>, <em>rlang(v.1.1.2)</em>, <em>magrittr(v.2.0.3)</em>, <em>furrr(v.0.3.1)</em>, <em>compiler(v.4.3.2)</em>, <em>vctrs(v.0.6.4)</em>, <em>stringr(v.1.5.1)</em>, <em>lhs(v.1.1.6)</em>, <em>rvest(v.1.0.3)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>fastmap(v.1.1.1)</em>, <em>ellipsis(v.0.3.2)</em>, <em>backports(v.1.4.1)</em>, <em>pander(v.0.6.5)</em>, <em>KMsurv(v.0.1-5)</em>, <em>utf8(v.1.2.4)</em>, <em>datefixR(v.1.6.0.9000)</em>, <em>rmarkdown(v.2.25)</em>, <em>prodlim(v.2023.08.28)</em>, <em>xfun(v.0.41)</em>, <em>jsonlite(v.1.8.7)</em>, <em>parallel(v.4.3.2)</em>, <em>R6(v.2.5.1)</em>, <em>stringi(v.1.8.1)</em>, <em>parallelly(v.1.36.0)</em>, <em>car(v.3.1-2)</em>, <em>rpart(v.4.1.21)</em>, <em>lubridate(v.1.9.3)</em>, <em>Rcpp(v.1.0.11)</em>, <em>iterators(v.1.0.14)</em>, <em>knitr(v.1.45)</em>, <em>future.apply(v.1.11.0)</em>, <em>zoo(v.1.8-12)</em>, <em>clisymbols(v.1.2.0)</em>, <em>Matrix(v.1.6-3)</em>, <em>splines(v.4.3.2)</em>, <em>timechange(v.0.2.0)</em>, <em>tidyselect(v.1.2.0)</em>, <em>rstudioapi(v.0.15.0)</em>, <em>abind(v.1.4-5)</em>, <em>yaml(v.2.3.7)</em>, <em>timeDate(v.4022.108)</em>, <em>codetools(v.0.2-19)</em>, <em>listenv(v.0.9.0)</em>, <em>lattice(v.0.21-9)</em>, <em>withr(v.2.5.2)</em>, <em>evaluate(v.0.23)</em>, <em>future(v.1.33.0)</em>, <em>xml2(v.1.3.5)</em>, <em>survMisc(v.0.5.6)</em>, <em>pillar(v.1.9.0)</em>, <em>carData(v.3.0-5)</em>, <em>foreach(v.1.5.2)</em>, <em>generics(v.0.1.3)</em>, <em>munsell(v.0.5.0)</em>, <em>globals(v.0.16.2)</em>, <em>xtable(v.1.8-4)</em>, <em>class(v.7.3-22)</em>, <em>glue(v.1.6.2)</em>, <em>tools(v.4.3.2)</em>, <em>data.table(v.1.14.8)</em>, <em>gower(v.1.0.1)</em>, <em>ggsignif(v.0.6.4)</em>, <em>grid(v.4.3.2)</em>, <em>ipred(v.0.9-14)</em>, <em>colorspace(v.2.1-0)</em>, <em>cli(v.3.6.1)</em>, <em>DiceDesign(v.1.9)</em>, <em>rappdirs(v.0.3.3)</em>, <em>km.ci(v.0.5-6)</em>, <em>fansi(v.1.0.5)</em>, <em>lava(v.1.7.3)</em>, <em>gtable(v.0.3.4)</em>, <em>GPfit(v.1.0-8)</em>, <em>rstatix(v.0.7.2)</em>, <em>digest(v.0.6.33)</em>, <em>htmlwidgets(v.1.6.3)</em>, <em>htmltools(v.0.5.7)</em>, <em>lifecycle(v.1.0.4)</em>, <em>hardhat(v.1.3.0)</em>, <em>httr(v.1.4.7)</em> and <em>MASS(v.7.3-60)</em></p>
</div>
</div>
</section><div id="quarto-appendix" class="default"><section id="section" class="level2 appendix"><h2 class="quarto-appendix-heading"></h2><div class="quarto-appendix-contents">
<p><img class="center" src="images/MRC_HGU_Edinburgh RGB.png" alt="MRC Human Genetics Unit logo" height="50px"><img src="images/cgem-logo.png" alt="Centre for Genomic &amp; Experimental Medicine logo" height="50px"></p>
</div></section><section id="acknowledgments" class="level2 appendix"><h2 class="quarto-appendix-heading">Acknowledgments</h2><div class="quarto-appendix-contents">
<p>This work is funded by the Medical Research Council &amp; University of Edinburgh via a Precision Medicine PhD studentship (MR/N013166/1, to <strong>NC-C</strong>)</p>
</div></section><section id="author-contributions" class="level2 appendix"><h2 class="quarto-appendix-heading">Author contributions</h2><div class="quarto-appendix-contents">
<p><strong>NC-C</strong> wrote the analysis. <strong>KM</strong> and <strong>CAV</strong> performed code review and contributed suggestions. <strong>RM</strong> contributed functions for calculating descriptive statistics. <strong>KM</strong>, <strong>RM</strong> and <strong>CAV</strong> provided feedback.</p>
</div></section><section id="reuse" class="level2 appendix"><h2 class="quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents">
<p>Licensed by <a href="https://creativecommons.org/licenses/by/4.0/">CC BY</a> except for the MRC Human Genetics Unit, The University of Edinburgh, and Centre for Genomic &amp; Experimental Medicine logos or unless otherwise stated.</p>


</div></section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{constantine-cooke2023,
  author = {Nathan Constantine-Cooke and Karla Monterrubio-Gómez and
    Nikolas Plevris and Lauranne A.A.P. Derikx and Beatriz Gros and
    Gareth-Rhys Jones and Riccardo E. Marioni and Charlie W. Lees and
    Catalina A. Vallejos},
  publisher = {Elsevier},
  title = {Longitudinal {Fecal} {Calprotectin} {Profiles} {Characterize}
    {Disease} {Course} {Heterogeneity} in {Crohn’s} {Disease}},
  journal = {Clinical Gastroenterology and Hepatology},
  date = {2023-11-24},
  url = {https://www.cghjournal.org/article/S1542-3565(23)00234-3/},
  doi = {10.1016/j.cgh.2023.03.026},
  issn = {1542-3565},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-constantine-cooke2023" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Nathan Constantine-Cooke, Karla Monterrubio-Gómez, Nikolas Plevris,
Lauranne A.A.P. Derikx, Beatriz Gros, Gareth-Rhys Jones, Riccardo E.
Marioni, Charlie W. Lees, and Catalina A. Vallejos. 2023.
<span>“Longitudinal Fecal Calprotectin Profiles Characterize Disease
Course Heterogeneity in Crohn’s Disease.”</span> <em>Clinical
Gastroenterology and Hepatology</em>, November. <a href="https://doi.org/10.1016/j.cgh.2023.03.026">https://doi.org/10.1016/j.cgh.2023.03.026</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, The Authors</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vallejosgroup/lcmm-site">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/IBDNathan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>