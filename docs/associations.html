<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nathan Contantine-Cooke">
<meta name="author" content="Karla Monterrubio-Gómez">
<meta name="author" content="Riccardo E. Marioni">
<meta name="author" content="Catalina A. Vallejos">
<meta name="dcterms.date" content="2022-10-05">
<title>Analysis by Constantine-Cooke et al.&nbsp;- Association Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<link rel="stylesheet" href="theme.css">
<meta property="og:title" content="Analysis by Constantine-Cooke et al.&nbsp;- Association Testing">
<meta property="og:description" content="Comparing demographic data, clinical data, and outcomes across clusters.">
<meta property="og:site-name" content="Analysis by Constantine-Cooke et al.">
<meta name="twitter:title" content="Analysis by Constantine-Cooke et al.&nbsp;- Association Testing">
<meta name="twitter:description" content="Comparing demographic data, clinical data, and outcomes across clusters.">
<meta name="twitter:creator" content="@nathansam">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="Association Testing">
<meta name="citation_author" content="Nathan Contantine-Cooke">
<meta name="citation_author" content="Karla Monterrubio-Gómez">
<meta name="citation_author" content="Riccardo E. Marioni">
<meta name="citation_author" content="Catalina A. Vallejos">
<meta name="citation_publication_date" content="NaN-NaN-NaN">
<meta name="citation_cover_date" content="NaN-NaN-NaN">
<meta name="citation_year" content="NaN">
<meta name="citation_online_date" content="NaN-NaN-NaN">
<meta name="citation_doi" content="10.1101/2022.08.16.22278320">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Normalization of fecal calprotectin within 12 months of diagnosis is associated with reduced risk of disease progression in patients with Crohn’s disease;,citation_author=Nikolas Plevris;,citation_author=James Fulforth;,citation_author=Mathew Lyons;,citation_author=Spyros I. Siakavellas;,citation_author=Philip W. Jenkinson;,citation_author=Cher S. Chuah;,citation_author=Laura Lucaciu;,citation_author=Rebecca J. Pattenden;,citation_author=Ian D. Arnott;,citation_author=Gareth-Rhys Jones;,citation_author=Charlie W. Lees;,citation_publication_date=2021-09;,citation_cover_date=2021-09;,citation_year=2021;,citation_issue=9;,citation_doi=10.1016/j.cgh.2020.08.022;,citation_volume=19;,citation_journal_title=Clinical Gastroenterology and Hepatology;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Ulcerative colitis and clinical course: Results of a 5-year population-based follow-up study (the IBSEN study);,citation_author=Magne Henriksen;,citation_author=Jrgen Jahnsen;,citation_author=Idar Lygren;,citation_author=Jostein Sauar;,citation_author=undefined Kjellevold;,citation_author=Tom Schulz;,citation_author=Morten H. Vatn;,citation_author=Bjrn Moum;,citation_publication_date=2006-07;,citation_cover_date=2006-07;,citation_year=2006;,citation_issue=7;,citation_doi=10.1097/01.mib.0000225339.91484.fc;,citation_volume=12;,citation_journal_title=Inflammatory Bowel Diseases;,citation_publisher=Oxford University Press (OUP);">
<meta name="citation_reference" content="citation_title=Polynomials and potential theory for gaussian radial basis function interpolation;,citation_abstract=We explore a connection between Gaussian radial basis functions and polynomials. Using standard tools of potential theory, we find that these radial functions are susceptible to the Runge phenomenon, not only in the limit of increasingly flat functions, but also in the finite shape parameter case. We show that there exist interpolation node distributions that prevent such phenomena and allow stable approximations. Using polynomials also provides an explicitinterpolation formula that avoids the difficulties of inverting interpolation matrices, while not imposing restrictions on the shape parameter or number of points.;,citation_author=Rodrigo B. Platte;,citation_author=Tobin A. Driscoll;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;,citation_fulltext_html_url=https://doi.org/10.1137/040610143;,citation_issue=2;,citation_doi=10.1137/040610143;,citation_volume=43;,citation_journal_title=SIAM Journal on Numerical Analysis;">
<meta name="citation_reference" content="citation_title=Estimation of extended mixed models using latent classes and latent processes: The R package lcmm;,citation_author=Cécile Proust-Lima;,citation_author=Viviane Philipps;,citation_author=Benoit Liquet;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_issue=2;,citation_doi=10.18637/jss.v078.i02;,citation_volume=78;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=Regression modeling strategies;,citation_author=undefined Frank E. Harrell;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_doi=10.1007/978-3-319-19425-7;">
<meta name="citation_reference" content="citation_title=The runge phenomenon and spatially variable shape parameters in RBF interpolation;,citation_abstract=Many studies, mostly empirical, have been devoted to finding an optimal shape parameter for radial basis functions (RBF). When exploring the underlying factors that determine what is a good such choice, we are led to consider the Runge phenomenon (RP; best known in cases of high order polynomial interpolation) as a key error mechanism. This observation suggests that it can be advantageous to let the shape parameter vary spatially, rather than assigning a single value to it. Benefits typically include improvements in both accuracy and numerical conditioning. Still another benefit arises if one wishes to improve local accuracy by clustering nodes in selected areas. This idea is routinely used when working with splines or finite element methods. However, local refinement with RBFs may cause RP-type errors unless we use a spatially variable shape paremeter. With this enhancement, RBF approximations combine freedom from meshes with spectral accuracy on irregular domains, and furthermore permit local node clustering to improve the resolution wherever this might be needed.;,citation_author=Bengt Fornberg;,citation_author=Julia Zuev;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S0898122107002210;,citation_issue=3;,citation_doi=https://doi.org/10.1016/j.camwa.2007.01.028;,citation_issn=0898-1221;,citation_volume=54;,citation_journal_title=Computers &amp;amp;amp; Mathematics with Applications;">
<meta name="citation_reference" content="citation_title=Using linear and natural cubic splines, SITAR, and latent trajectory models to characterise nonlinear longitudinal growth trajectories in cohort studies;,citation_abstract=Longitudinal data analysis can improve our understanding of the influences on health trajectories across the life-course. There are a variety of statistical models which can be used, and their fitting and interpretation can be complex, particularly where there is a nonlinear trajectory. Our aim was to provide an accessible guide along with applied examples to using four sophisticated modelling procedures for describing nonlinear growth trajectories.;,citation_author=Ahmed Elhakeem;,citation_author=Rachael A. Hughes;,citation_author=Kate Tilling;,citation_author=Diana L. Cousminer;,citation_author=Stefan A. Jackowski;,citation_author=Tim J. Cole;,citation_author=Alex S. F. Kwong;,citation_author=Zheyuan Li;,citation_author=Struan F. A. Grant;,citation_author=Adam D. G. Baxter-Jones;,citation_author=Babette S. Zemel;,citation_author=Deborah A. Lawlor;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://doi.org/10.1186/s12874-022-01542-8;,citation_issue=1;,citation_doi=10.1186/s12874-022-01542-8;,citation_isbn=1471-2288;,citation_volume=22;,citation_journal_title=BMC Medical Research Methodology;">
<meta name="citation_reference" content="citation_title=Asymptotically efficient rank invariant test procedures;,citation_author=Richard Peto;,citation_author=Julian Peto;,citation_publication_date=1972;,citation_cover_date=1972;,citation_year=1972;,citation_issue=2;,citation_doi=10.2307/2344317;,citation_volume=135;,citation_journal_title=Journal of the Royal Statistical Society. Series A (General);,citation_publisher=JSTOR;">
</head>
<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Analysis by Constantine-Cooke et al.</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="./index.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./data-cleaning.html">Data Cleaning</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./selection.html">Model Selection</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./associations.html" aria-current="page">Association Testing</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vallejosgroup/lcmm-site"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#outcomes" id="toc-outcomes" class="nav-link" data-scroll-target="#outcomes">Outcomes</a></li>
  <li><a href="#characteristics-available-at-diagnosis" id="toc-characteristics-available-at-diagnosis" class="nav-link" data-scroll-target="#characteristics-available-at-diagnosis">Characteristics available at diagnosis</a></li>
  <li><a href="#treatment-effects" id="toc-treatment-effects" class="nav-link" data-scroll-target="#treatment-effects">Treatment effects</a></li>
  <li>
<a href="#predictive-models" id="toc-predictive-models" class="nav-link" data-scroll-target="#predictive-models">Predictive models</a>
  <ul class="collapse">
<li><a href="#all-clusters" id="toc-all-clusters" class="nav-link" data-scroll-target="#all-clusters">All clusters</a></li>
  <li><a href="#cluster-2-16" id="toc-cluster-2-16" class="nav-link" data-scroll-target="#cluster-2-16">Cluster 2</a></li>
  </ul>
</li>
  <li><a href="#session-information" id="toc-session-information" class="nav-link" data-scroll-target="#session-information">Session information</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
  <li><a href="#author-contributions" id="toc-author-contributions" class="nav-link" data-scroll-target="#author-contributions">Author contributions</a></li>
  <li><a href="#reuse" id="toc-reuse" class="nav-link" data-scroll-target="#reuse">Reuse</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/vallejosgroup/lcmm-site/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Association Testing</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button" data-quarto-source-url="https://github.com/vallejosgroup/lcmm-site/blob/main/associations.qmd">View Source</a></li></ul></div></div>
<p class="subtitle lead">Comparing demographic data, clinical data, and outcomes across clusters.</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=2emHWR0AAAAJ&amp;hl=en&amp;oi=ao">Nathan Contantine-Cooke</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/centre-genomic-medicine">
            Centre for Genomic and Experimental Medicine
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=YmyxSXAAAAAJ&amp;hl=en">Karla Monterrubio-Gómez</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?hl=en&amp;user=gA3Ik3MAAAAJ">Riccardo E. Marioni</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/centre-genomic-medicine">
            Centre for Genomic and Experimental Medicine
            </a>
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    <a href="https://scholar.google.com/citations?user=lkdrwm0AAAAJ&amp;hl=en&amp;oi=ao">Catalina A. Vallejos</a> 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
        <p class="affiliation">
            <a href="https://www.turing.ac.uk">
            The Alan Turing Institute
            </a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 5, 2022</p>
    </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Doi</div>
    <div class="quarto-title-meta-contents">
      <p class="doi">
        <a href="https://doi.org/10.1101/2022.08.16.22278320">10.1101/2022.08.16.22278320</a>
      </p>
    </div>
  </div>
  </div>
  

</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a></span><span class="op">)</span> <span class="co"># Multinomial logistic regression</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span> <span class="co"># Modelling framework</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/imbs-hl/ranger">ranger</a></span><span class="op">)</span> <span class="co"># Random forest</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival">survival</a></span><span class="op">)</span> <span class="co"># Kaplan-Meier</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html">survminer</a></span><span class="op">)</span> <span class="co"># Plot Kaplan-Meier curves</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/koalaverse/vip/">vip</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">KONPsurv</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"plyr"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">########################</span></span>
<span><span class="co">#-- Custom Functions --#</span></span>
<span><span class="co">########################</span></span>
<span></span>
<span><span class="co">#' @title Calculate descriptive statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @param vars Character vector of continuous variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Finds the median, first quartile, third quartile, minimum and maximum</span></span>
<span><span class="co">#'   statistics for non-normal continuous variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 7 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cont</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Q3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         Max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">med</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">out_desc</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">var</span>, <span class="va">n</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">med</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out_desc</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#' @title Calculate descriptive statistics for categorical variables</span></span>
<span><span class="co">#' @param vars Character vector of categorical variable names</span></span>
<span><span class="co">#' @param data Dataframe object</span></span>
<span><span class="co">#' @description</span></span>
<span><span class="co">#' Prints frequency and proportional tables for given categorical variables</span></span>
<span><span class="co">#' @return A dataframe object with length(vars) rows and 3 columns</span></span>
<span><span class="co">#' corresponding to the descriptive statistics calculated</span></span>
<span><span class="va">describe_cat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">vars</span>, <span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/is_tibble.html">is_tibble</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">vars</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">var</span> <span class="op">&lt;-</span> <span class="va">vars</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="va">var</span><span class="op">]</span>, useNA <span class="op">=</span> <span class="st">"always"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">kaplan_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">title</span>, <span class="va">subtitle</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">legend</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">legend</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survminer/man/ggsurvplot.html">ggsurvplot</a></span><span class="op">(</span><span class="va">model</span>,</span>
<span>                    conf.int <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    surv.median.line <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                    pval <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    pval.method <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    ggtheme <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>                                                      size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>                            <span class="op">)</span>,</span>
<span>                    pval.size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                    legend <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subtitle</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span>, <span class="st">"Stratified by cluster"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Time (years)"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>After <a href="./selection.html">deeming the four-cluster LCMM to be the most suitable</a>, we will now explore potential associations with cluster membership. We will consider variables typically available at diagnosis, outcomes usually indicative of a poor disease course, and treatments prescribed within one year of diagnosis. For all categorical variables, frequency tables for the study population and clusters have been generated in addition to either chi-squared test or (if a cell has &lt; 5 observations) Fisher’s exact test results. For continuous variables, the median, first quartile, and third quartile have been reported for the study population and clusters in addition to ANOVA results.</p>
<p>To streamline the analysis, descriptive functions have been created, <code>describe_cat()</code> and <code>describe_cont()</code> which generate the aforementioned results</p>
<p>We also attempt to predict cluster membership based on these variables to determine if cluster membership can be accurately predicted ahead of time using these variables. We consider both multinomial logistic regression and random forest predictive models for this purpose.</p>
</section><section id="outcomes" class="level2"><h2 class="anchored" data-anchor-id="outcomes">Outcomes</h2>
<p>We will first consider associations with outcomes in order to determine if there is are potentially clinically significant aspects to these clusters. For this purpose, we use Kaplan-Meier curves for endpoints of interest stratified by cluster membership. The endpoints considered are hospitalisation, surgery, disease progression, and a composite end point. We use log-rank tests to determine if survival distributions differ across clusters. All censoring indicators have been mapped to 0 (censored) and 1 (observed). Patients who met one of these endpoints within one year of diagnosis were excluded from the Crohn’s disease inception cohort and therefore no endpoints are observed within one year of diagnosis for the study cohort. For more information, see the <a href="./data-cleaning.html">Data Cleaning Section</a>.</p>
<p>For comparisons between survival curves, we consider both Mantel-Haenszel tests and Peto-Peto tests (modified Gehan-Wilcoxon tests) <span class="citation" data-cites="Peto1972">(<a href="#ref-Peto1972" role="doc-biblioref">Peto and Peto 1972</a>)</span> as the latter is more robust against violations of the proportional-hazards assumption. We also report the results of <span class="math inline">K</span>-sample omnibus non-proportional hazards (KONP) tests.</p>
<p>We have found the survival distributions for hospitalisation, disease progression, and the composite endpoint to be significantly different across clusters but not the survival distribution for the surgery endpoint.</p>
<p>From the below plots, we can clearly see cluster 1, which is characterised by a decrease in FCAL, results in high survival probabilities over time.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/processed-data/cdi/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"cache/cubicbf.fits.RDS"</span><span class="op">)</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">class</span>,</span>
<span>                                     from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                     to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/data/"</span>,</span>
<span>                               <span class="st">"crohns-inception/20220328/"</span>,</span>
<span>                               <span class="st">"Nathan_FCprogressioncohort.csv"</span><span class="op">)</span></span>
<span>                         <span class="op">)</span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">Number</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">$</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"id"</span></span>
<span><span class="va">classes</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">pprob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">classes</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">demographic</span><span class="op">$</span><span class="va">class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Hospitalisation</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Surgery</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Disease progression</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Composite endpoint</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<section id="mantel-haenszel-test" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"hosp.date"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.censor</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"hosp"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"hosp.date"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">hosp.censor</span> <span class="op">&lt;-</span> <span class="va">hosp.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">hosp.time</span> <span class="op">&lt;-</span> <span class="va">hosp.time</span></span>
<span></span>
<span><span class="va">hosp.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">hosp.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">hosp.model</span>, <span class="st">"Kaplan-Meier Curves for Hospitalisation"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="peto-peto-test" class="level4"><h4 class="anchored" data-anchor-id="peto-peto-test">Peto-Peto Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">hosp.time</span>, <span class="va">hosp.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(hosp.time, hosp.censor) ~ cluster Chisq = 9.019292 on 3 degrees of freedom, p = 0.029035</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">10.01</td>
<td style="text-align: center;">20.72</td>
<td style="text-align: center;">5.529</td>
<td style="text-align: center;">8.672</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">48.73</td>
<td style="text-align: center;">39.86</td>
<td style="text-align: center;">1.975</td>
<td style="text-align: center;">4.724</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">13.17</td>
<td style="text-align: center;">12.42</td>
<td style="text-align: center;">0.04507</td>
<td style="text-align: center;">0.06193</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">4.484</td>
<td style="text-align: center;">3.402</td>
<td style="text-align: center;">0.3444</td>
<td style="text-align: center;">0.414</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="konp-test" class="level4"><h4 class="anchored" data-anchor-id="konp-test">KONP Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/KONPsurv/man/konp_test.html">konp_test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">hosp.time</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">hosp.censor</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>          n_perm <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pv_chisq
[1] 0.005994006

$pv_lr
[1] 0.001998002

$pv_cauchy
[1] 0.002913057

$chisq_test_stat
[1] 4.158485

$lr_test_stat
[1] 4.423901

$cauchy_test_stat
[1] 109.267</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<section id="mantel-haenszel-test-1" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-1">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"surg.date"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.censor</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>  </span>
<span>    <span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"surg"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"surg.date"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">surg.censor</span> <span class="op">&lt;-</span> <span class="va">surg.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">surg.time</span> <span class="op">&lt;-</span> <span class="va">surg.time</span></span>
<span></span>
<span><span class="va">surg.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">surg.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">surg.model</span>, <span class="st">"Kaplan-Meier Curves for Surgery"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="peto-peto-test-1" class="level4"><h4 class="anchored" data-anchor-id="peto-peto-test-1">Peto-Peto Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">surg.time</span>, <span class="va">surg.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(surg.time, surg.censor) ~ cluster Chisq = 3.659372 on 3 degrees of freedom, p = 0.300673</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">4.676</td>
<td style="text-align: center;">7.883</td>
<td style="text-align: center;">1.305</td>
<td style="text-align: center;">1.844</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">16.11</td>
<td style="text-align: center;">16.23</td>
<td style="text-align: center;">0.0009053</td>
<td style="text-align: center;">0.002028</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">6.898</td>
<td style="text-align: center;">4.995</td>
<td style="text-align: center;">0.7248</td>
<td style="text-align: center;">0.9097</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">2.82</td>
<td style="text-align: center;">1.395</td>
<td style="text-align: center;">1.457</td>
<td style="text-align: center;">1.603</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="konp-test-1" class="level4"><h4 class="anchored" data-anchor-id="konp-test-1">KONP Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/KONPsurv/man/konp_test.html">konp_test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">surg.time</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">surg.censor</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>          n_perm <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pv_chisq
[1] 0.1328671

$pv_lr
[1] 0.1388611

$pv_cauchy
[1] 0.09757382

$chisq_test_stat
[1] 1.631954

$lr_test_stat
[1] 1.671129

$cauchy_test_stat
[1] 3.159422</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<section id="mantel-haenszel-test-2" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-2">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"prog.date"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.censor</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>  </span>
<span>    <span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"prog"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"prog.date"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">prog.censor</span> <span class="op">&lt;-</span> <span class="va">prog.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">prog.time</span> <span class="op">&lt;-</span> <span class="va">prog.time</span></span>
<span><span class="va">prog.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">prog.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">prog.model</span>, <span class="st">"Kaplan-Meier Curves for Disease Progression"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="peto-peto-test-2" class="level4"><h4 class="anchored" data-anchor-id="peto-peto-test-2">Peto-Peto Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">prog.time</span>, <span class="va">prog.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(prog.time, prog.censor) ~ cluster Chisq = 13.215526 on 3 degrees of freedom, p = 0.004193</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">1.803</td>
<td style="text-align: center;">11.6</td>
<td style="text-align: center;">8.274</td>
<td style="text-align: center;">12.09</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">32.28</td>
<td style="text-align: center;">22.79</td>
<td style="text-align: center;">3.952</td>
<td style="text-align: center;">8.872</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">7.78</td>
<td style="text-align: center;">7.181</td>
<td style="text-align: center;">0.04985</td>
<td style="text-align: center;">0.06415</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">1.837</td>
<td style="text-align: center;">2.129</td>
<td style="text-align: center;">0.04019</td>
<td style="text-align: center;">0.04558</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="konp-test-2" class="level4"><h4 class="anchored" data-anchor-id="konp-test-2">KONP Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/KONPsurv/man/konp_test.html">konp_test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">prog.time</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">prog.censor</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>          n_perm <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pv_chisq
[1] 0.001998002

$pv_lr
[1] 0.000999001

$pv_cauchy
[1] 0.0005548132

$chisq_test_stat
[1] 4.651166

$lr_test_stat
[1] 5.877664

$cauchy_test_stat
[1] 573.7239</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<section id="mantel-haenszel-test-3" class="level4"><h4 class="anchored" data-anchor-id="mantel-haenszel-test-3">Mantel-Haenszel Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"composites.day"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">5</span> <span class="op">*</span> <span class="fl">365.25</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.censor</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="fl">5</span> <span class="op">*</span> <span class="fl">365.25</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>  </span>
<span>    <span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.censor</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"composite"</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">subject</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"composites.day"</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">composite.censor</span> <span class="op">&lt;-</span> <span class="va">composite.censor</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">composite.time</span> <span class="op">&lt;-</span> <span class="va">composite.time</span> <span class="op">/</span> <span class="fl">365.25</span></span>
<span></span>
<span><span class="va">comp.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html">survfit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">composite.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span></span>
<span><span class="fu">kaplan_plot</span><span class="op">(</span><span class="va">comp.model</span>, <span class="st">"Kaplan-Meier Curves for Composite Endpoint"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="associations_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="peto-peto-test-3" class="level4"><h4 class="anchored" data-anchor-id="peto-peto-test-3">Peto-Peto Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">pander</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html">survdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html">Surv</a></span><span class="op">(</span><span class="va">composite.time</span>, <span class="va">composite.censor</span><span class="op">)</span> <span class="op">~</span> <span class="va">cluster</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">demographic</span>,</span>
<span>                        rho <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<caption>Call: Surv(composite.time, composite.censor) ~ cluster Chisq = 11.929926 on 3 degrees of freedom, p = 0.007627</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">N</th>
<th style="text-align: center;">Observed</th>
<th style="text-align: center;">Expected</th>
<th style="text-align: center;">(O-E)^2/E</th>
<th style="text-align: center;">(O-E)^2/V</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=1</strong></td>
<td style="text-align: center;">92</td>
<td style="text-align: center;">12.21</td>
<td style="text-align: center;">24.36</td>
<td style="text-align: center;">6.066</td>
<td style="text-align: center;">9.798</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=2</strong></td>
<td style="text-align: center;">191</td>
<td style="text-align: center;">55</td>
<td style="text-align: center;">47.96</td>
<td style="text-align: center;">1.036</td>
<td style="text-align: center;">2.608</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>cluster=3</strong></td>
<td style="text-align: center;">58</td>
<td style="text-align: center;">16.24</td>
<td style="text-align: center;">14.32</td>
<td style="text-align: center;">0.2573</td>
<td style="text-align: center;">0.3636</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>cluster=4</strong></td>
<td style="text-align: center;">15</td>
<td style="text-align: center;">6.863</td>
<td style="text-align: center;">3.675</td>
<td style="text-align: center;">2.764</td>
<td style="text-align: center;">3.387</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="konp-test-3" class="level4"><h4 class="anchored" data-anchor-id="konp-test-3">KONP Test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/KONPsurv/man/konp_test.html">konp_test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">composite.time</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">composite.censor</span>,</span>
<span>          <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>          n_perm<span class="op">=</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>$pv_chisq
[1] 0.05894106

$pv_lr
[1] 0.05494505

$pv_cauchy
[1] 0.001979399

$chisq_test_stat
[1] 2.213073

$lr_test_stat
[1] 2.243513

$cauchy_test_stat
[1] 160.8093</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="characteristics-available-at-diagnosis" class="level2"><h2 class="anchored" data-anchor-id="characteristics-available-at-diagnosis">Characteristics available at diagnosis</h2>
<p>We have found two variables available at diagnosis to be associated with cluster membership: smoking at diagnosis (<span class="math inline">p = 0.015</span>) and upper gastrointestinal inflammation (Montreal L4; <span class="math inline">p &lt; 0.001</span>).</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Sex</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Age at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Smoking at diagnosis</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Diagnostic FCAL</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Montreal behaviour</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">Perianal</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">Montreal location</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">Upper GI</a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<section id="population" class="level4"><h4 class="anchored" data-anchor-id="population">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
 173  183    0 

        F         M      &lt;NA&gt; 
0.4859551 0.5140449 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-1">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  49   43    0 

        F         M      &lt;NA&gt; 
0.5326087 0.4673913 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-2">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  84  107    0 

        F         M      &lt;NA&gt; 
0.4397906 0.5602094 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-3">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
  34   24    0 

        F         M      &lt;NA&gt; 
0.5862069 0.4137931 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-4">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"SEX"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   F    M &lt;NA&gt; 
   6    9    0 

   F    M &lt;NA&gt; 
 0.4  0.6  0.0 </code></pre>
</div>
</div>
</section><section id="chi-squared-test" class="level4"><h4 class="anchored" data-anchor-id="chi-squared-test">Chi-squared test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">SEX</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  demographic$SEX and demographic$cluster
X-squared = 5.2083, df = 3, p-value = 0.1572</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<section id="population-1" class="level4"><h4 class="anchored" data-anchor-id="population-1">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median Q1   Q3  Min  Max
1      age 356   27.3 16 48.7 3.75 87.1</code></pre>
</div>
</div>
</section><section id="cluster-1-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-1">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 92   29.6 20.4 45.3 6.87 87.1</code></pre>
</div>
</div>
</section><section id="cluster-2-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-1">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median   Q1   Q3  Min  Max
1      age 191   26.4 15.3 49.9 3.75 81.3</code></pre>
</div>
</div>
</section><section id="cluster-3-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-1">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 58   26.8 15.1 50.9 4.98 78.4</code></pre>
</div>
</div>
</section><section id="cluster-4-1" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-1">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"age"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median   Q1   Q3  Min  Max
1      age 15   21.7 14.5 51.2 10.5 71.3</code></pre>
</div>
</div>
</section><section id="anova" class="level4"><h4 class="anchored" data-anchor-id="anova">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">age</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value Pr(&gt;F)
class         1     14    14.5   0.036  0.851
Residuals   354 144163   407.2               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>If a participant has reported to have not smoked in the past, then it is assumed the participant did not smoke at IBD diagnosis. Otherwise smoking status is taken from the participant’s response to being asked if they were smoking when diagnosed with IBD.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"SMOKER..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"smoking"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-2" class="level4"><h4 class="anchored" data-anchor-id="population-2">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 286   70    0 

       no       yes      &lt;NA&gt; 
0.8033708 0.1966292 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-2">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  70   22    0 

       no       yes      &lt;NA&gt; 
0.7608696 0.2391304 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-2">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 148   43    0 

       no       yes      &lt;NA&gt; 
0.7748691 0.2251309 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-2">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  54    4    0 

        no        yes       &lt;NA&gt; 
0.93103448 0.06896552 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-2" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-2">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"smoking"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  14    1    0 

        no        yes       &lt;NA&gt; 
0.93333333 0.06666667 0.00000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">smoking</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$smoking
p-value = 0.01455
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<section id="population-3" class="level4"><h4 class="anchored" data-anchor-id="population-3">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"/Volumes/igmm/cvallejo-predicct/processed-data/cdi/"</span>,</span>
<span>                               <span class="st">"FCcumulativeLongInc.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FCcumulative</span> <span class="op">&lt;-</span> <span class="va">FCcumulative</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">FCcumulative</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">subject</span> <span class="op">&lt;-</span> <span class="va">demographic</span><span class="op">[</span><span class="va">i</span>, <span class="st">"id"</span><span class="op">]</span></span>
<span>  <span class="va">subject.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">FCcumulative</span>, <span class="va">id</span> <span class="op">==</span> <span class="va">subject</span><span class="op">)</span></span>
<span>  <span class="va">DiagFC</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">subject.data</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"value"</span><span class="op">]</span> <span class="co"># Already sorted by time</span></span>
<span><span class="op">}</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">DiagFC</span> <span class="op">&lt;-</span> <span class="va">DiagFC</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 356    820 590 1140 250 2500</code></pre>
</div>
</div>
</section><section id="cluster-1-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-3">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1  Q3 Min  Max
1   DiagFC 92    725 500 986 253 2500</code></pre>
</div>
</div>
</section><section id="cluster-2-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-3">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable   n Median  Q1   Q3 Min  Max
1   DiagFC 191    900 610 1270 250 2500</code></pre>
</div>
</div>
</section><section id="cluster-3-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-3">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 58    825 592 1180 310 2500</code></pre>
</div>
</div>
</section><section id="cluster-4-3" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-3">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"DiagFC"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Variable  n Median  Q1   Q3 Min  Max
1   DiagFC 15    660 630 1160 470 2040</code></pre>
</div>
</div>
</section><section id="anova-1" class="level4"><h4 class="anchored" data-anchor-id="anova-1">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">DiagFC</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1    676441  676441   2.295  0.131
Residuals   354 104332274  294724               </code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BEHAVIOUR.AT.DIAGNOSIS"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"behaviour"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-4" class="level4"><h4 class="anchored" data-anchor-id="population-4">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 323   30    3    0 

          1           2           3        &lt;NA&gt; 
0.907303371 0.084269663 0.008426966 0.000000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-4">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  80   10    2    0 

         1          2          3       &lt;NA&gt; 
0.86956522 0.10869565 0.02173913 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-4">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
 175   15    1    0 

          1           2           3        &lt;NA&gt; 
0.916230366 0.078534031 0.005235602 0.000000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-4">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  55    3    0    0 

         1          2          3       &lt;NA&gt; 
0.94827586 0.05172414 0.00000000 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-4" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-4">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"behaviour"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
  13    2    0    0 

        1         2         3      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-1" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-1">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">behaviour</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$behaviour
p-value = 0.4937
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"PERIANAL.DISEASE..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"peri"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">peri</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-5" class="level4"><h4 class="anchored" data-anchor-id="population-5">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 299   57    0 

       no       yes      &lt;NA&gt; 
0.8398876 0.1601124 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-5">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  75   17    0 

       no       yes      &lt;NA&gt; 
0.8152174 0.1847826 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-5">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 163   28    0 

       no       yes      &lt;NA&gt; 
0.8534031 0.1465969 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-5">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  49    9    0 

       no       yes      &lt;NA&gt; 
0.8448276 0.1551724 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-5" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-5">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"peri"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  12    3    0 

  no  yes &lt;NA&gt; 
 0.8  0.2  0.0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-2" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-2">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">peri</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$peri
p-value = 0.7757
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span>, <span class="st">"L3"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-6" class="level4"><h4 class="anchored" data-anchor-id="population-6">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  95  140  121    0 

       L1        L2        L3      &lt;NA&gt; 
0.2668539 0.3932584 0.3398876 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-6">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  22   39   31    0 

       L1        L2        L3      &lt;NA&gt; 
0.2391304 0.4239130 0.3369565 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-6">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
  58   68   65    0 

       L1        L2        L3      &lt;NA&gt; 
0.3036649 0.3560209 0.3403141 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-6" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-6">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   9   30   19    0 

       L1        L2        L3      &lt;NA&gt; 
0.1551724 0.5172414 0.3275862 0.0000000 </code></pre>
</div>
</div>
<section id="cluster-4-6" class="level5"><h5 class="anchored" data-anchor-id="cluster-4-6">Cluster = 4</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb103"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"LOCATION"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  L1   L2   L3 &lt;NA&gt; 
   6    3    6    0 

  L1   L2   L3 &lt;NA&gt; 
 0.4  0.2  0.4  0.0 </code></pre>
</div>
</div>
</section></section><section id="fishers-exact-test-3" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-3">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb105"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">LOCATION</span>, workspace <span class="op">=</span> <span class="fl">800000</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$LOCATION
p-value = 0.125
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb107"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"L4.Modifier"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"L4"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">L4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-7" class="level4"><h4 class="anchored" data-anchor-id="population-7">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb108"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 272   84    0 

       no       yes      &lt;NA&gt; 
0.7640449 0.2359551 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-7">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb110"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  84    8    0 

        no        yes       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-7">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb112"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
 140   51    0 

       no       yes      &lt;NA&gt; 
0.7329843 0.2670157 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-7">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb114"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  38   20    0 

       no       yes      &lt;NA&gt; 
0.6551724 0.3448276 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-7" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-7">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb116"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"L4"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
  no  yes &lt;NA&gt; 
  10    5    0 

       no       yes      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-4" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-4">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb118"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">L4</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$L4
p-value = 0.0002175
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="treatment-effects" class="level2"><h2 class="anchored" data-anchor-id="treatment-effects">Treatment effects</h2>
<p>To explore the potential presence of treatment effects, we have tested for associations between cluster membership and common IBD prescriptions. All treatments were prescribed within one year of diagnosis unless otherwise stated. Thioprine use (<span class="math inline">p = 0.02</span>), biologic use within three months of diagnosis (<span class="math inline">p &lt; 0.001</span>), and biologic use within one year of diagnosis (<span class="math inline">p &lt; 0.001</span>) were found to be significantly associated with cluster membership.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist">
<li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">5ASA</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Thioprine</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Corticosteroids</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Methotrexate</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">EEN</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">Biologic use within three months</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">Biologic use within one year</a></li>
<li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-8" role="tab" aria-controls="tabset-3-8" aria-selected="false">Date of diagnosis</a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<section id="population-8" class="level4"><h4 class="anchored" data-anchor-id="population-8">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb120"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 280   76    0 

        N         Y      &lt;NA&gt; 
0.7865169 0.2134831 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-8">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb122"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  77   15    0 

        N         Y      &lt;NA&gt; 
0.8369565 0.1630435 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-8">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb124"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 143   48    0 

        N         Y      &lt;NA&gt; 
0.7486911 0.2513089 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-8">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb126"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  47   11    0 

        N         Y      &lt;NA&gt; 
0.8103448 0.1896552 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-8" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-8">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb128"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"X5ASA"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  13    2    0 

        N         Y      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-5" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-5">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb130"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">X5ASA</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$X5ASA
p-value = 0.3261
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb132"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"THIOPURINE.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_thio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-9" class="level4"><h4 class="anchored" data-anchor-id="population-9">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb133"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 106  250    0 

        N         Y      &lt;NA&gt; 
0.2977528 0.7022472 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-9">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb135"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  30   62    0 

       N        Y     &lt;NA&gt; 
0.326087 0.673913 0.000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-9">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb137"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  64  127    0 

        N         Y      &lt;NA&gt; 
0.3350785 0.6649215 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-9">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb139"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   8   50    0 

       N        Y     &lt;NA&gt; 
0.137931 0.862069 0.000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-9" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-9">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb141"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_thio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   4   11    0 

        N         Y      &lt;NA&gt; 
0.2666667 0.7333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-6" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-6">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb143"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_thio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_thio
p-value = 0.02305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb145"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"CORTICOSTEROIDS.WITHIN.1st.YEAR...Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_cortico"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span>, <span class="st">"y"</span>, <span class="st">"Y"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-10" class="level4"><h4 class="anchored" data-anchor-id="population-10">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb146"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  58  298    0 

        N         Y      &lt;NA&gt; 
0.1629213 0.8370787 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-10">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb148"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  14   78    0 

        N         Y      &lt;NA&gt; 
0.1521739 0.8478261 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-10">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb150"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  32  159    0 

        N         Y      &lt;NA&gt; 
0.1675393 0.8324607 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-10">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb152"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10   48    0 

        N         Y      &lt;NA&gt; 
0.1724138 0.8275862 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-10" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-10">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb154"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_cortico"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   2   13    0 

        N         Y      &lt;NA&gt; 
0.1333333 0.8666667 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-7" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-7">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb156"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_cortico</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_cortico
p-value = 0.9829
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb158"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"MTX.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_mtx"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-11" class="level4"><h4 class="anchored" data-anchor-id="population-11">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb159"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 341   15    0 

         N          Y       &lt;NA&gt; 
0.95786517 0.04213483 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-11">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb161"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  84    8    0 

         N          Y       &lt;NA&gt; 
0.91304348 0.08695652 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-11">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb163"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 185    6    0 

         N          Y       &lt;NA&gt; 
0.96858639 0.03141361 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-11">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb165"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  57    1    0 

         N          Y       &lt;NA&gt; 
0.98275862 0.01724138 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-11" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-11">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb167"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_mtx"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N &lt;NA&gt; 
  15    0 

   N &lt;NA&gt; 
   1    0 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-8" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-8">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb169"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_mtx</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_mtx
p-value = 0.1393
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb171"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"EEN..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"EEN"</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span> <span class="op">&lt;-</span> <span class="fu">na_if</span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span>, <span class="st">""</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-12" class="level4"><h4 class="anchored" data-anchor-id="population-12">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb172"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 213   80   63 

        N         Y      &lt;NA&gt; 
0.5983146 0.2247191 0.1769663 </code></pre>
</div>
</div>
</section><section id="cluster-1-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-12">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb174"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  54   22   16 

        N         Y      &lt;NA&gt; 
0.5869565 0.2391304 0.1739130 </code></pre>
</div>
</div>
</section><section id="cluster-2-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-12">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb176"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 115   39   37 

        N         Y      &lt;NA&gt; 
0.6020942 0.2041885 0.1937173 </code></pre>
</div>
</div>
</section><section id="cluster-3-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-12">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb178"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  35   14    9 

        N         Y      &lt;NA&gt; 
0.6034483 0.2413793 0.1551724 </code></pre>
</div>
</div>
</section><section id="cluster-4-12" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-12">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb180"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"EEN"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
   9    5    1 

         N          Y       &lt;NA&gt; 
0.60000000 0.33333333 0.06666667 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-9" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-9">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb182"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">EEN</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$EEN
p-value = 0.7785
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb184"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.MONO...COMBO.WITHIN.3M"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio3"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-13" class="level4"><h4 class="anchored" data-anchor-id="population-13">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb185"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 312   44    0 

        0         1      &lt;NA&gt; 
0.8764045 0.1235955 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-13">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb187"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  69   23    0 

   0    1 &lt;NA&gt; 
0.75 0.25 0.00 </code></pre>
</div>
</div>
</section><section id="cluster-2-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-13">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb189"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
 177   14    0 

         0          1       &lt;NA&gt; 
0.92670157 0.07329843 0.00000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-13">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb191"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  53    5    0 

        0         1      &lt;NA&gt; 
0.9137931 0.0862069 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-13" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-13">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb193"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   0    1 &lt;NA&gt; 
  13    2    0 

        0         1      &lt;NA&gt; 
0.8666667 0.1333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-10" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-10">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb195"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_bio3
p-value = 0.0005305
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb197"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span> <span class="op">==</span> <span class="st">"BIOLOGIC.WITHIN.1st.YEAR..Y.N."</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"use_bio"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="population-14" class="level4"><h4 class="anchored" data-anchor-id="population-14">Population</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb198"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 262   94    0 

        N         Y      &lt;NA&gt; 
0.7359551 0.2640449 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-1-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-14">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb200"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  50   42    0 

        N         Y      &lt;NA&gt; 
0.5434783 0.4565217 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-2-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-14">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb202"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
 156   35    0 

        N         Y      &lt;NA&gt; 
0.8167539 0.1832461 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-3-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-14">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb204"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  46   12    0 

        N         Y      &lt;NA&gt; 
0.7931034 0.2068966 0.0000000 </code></pre>
</div>
</div>
</section><section id="cluster-4-14" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-14">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb206"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cat</span><span class="op">(</span><span class="st">"use_bio"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
   N    Y &lt;NA&gt; 
  10    5    0 

        N         Y      &lt;NA&gt; 
0.6666667 0.3333333 0.0000000 </code></pre>
</div>
</div>
</section><section id="fishers-exact-test-11" class="level4"><h4 class="anchored" data-anchor-id="fishers-exact-test-11">Fisher’s exact test</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb208"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">demographic</span><span class="op">$</span><span class="va">use_bio</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  demographic$cluster and demographic$use_bio
p-value = 1.823e-05
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
</div>
<div id="tabset-3-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-8-tab">
<p>Here, we consider the number of days from the start of the study period (2005-01-1) to when a subject was diagnosed to determine if when a subject was diagnosed has a statistically significant impact on which cluster a subject was assigned to.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb210"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span> <span class="op">&lt;-</span> <span class="fu">datefixR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/datefixR/man/fix_dates.html">fix_dates</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="st">"DATE.OF.DIAGNOSIS"</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">Days.From.Start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">DATE.OF.DIAGNOSIS</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2005-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="va">demographic</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 356   2980 2280 3840   0 4710</code></pre>
</div>
</div>
<section id="cluster-1-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-1-15">Cluster = 1</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb212"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 92   3060 2480 4000 150 4700</code></pre>
</div>
</div>
</section><section id="cluster-2-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-2-15">Cluster = 2</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb214"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable   n Median   Q1   Q3 Min  Max
1 Days.From.Start 191   3050 2110 3850   0 4710</code></pre>
</div>
</div>
</section><section id="cluster-3-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-3-15">Cluster = 3</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb216"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3 Min  Max
1 Days.From.Start 58   2840 2260 3790 424 4410</code></pre>
</div>
</div>
</section><section id="cluster-4-15" class="level4"><h4 class="anchored" data-anchor-id="cluster-4-15">Cluster = 4</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb218"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">describe_cont</span><span class="op">(</span><span class="st">"Days.From.Start"</span>, <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demographic</span>, <span class="va">class</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>         Variable  n Median   Q1   Q3  Min  Max
1 Days.From.Start 15   2820 2360 3430 1370 4300</code></pre>
</div>
</div>
</section><section id="anova-2" class="level4"><h4 class="anchored" data-anchor-id="anova-2">ANOVA</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb220"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Days.From.Start</span> <span class="op">~</span> <span class="va">class</span>, data <span class="op">=</span> <span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>             Df    Sum Sq Mean Sq F value Pr(&gt;F)
class         1   2713998 2713998   2.419  0.121
Residuals   354 397129240 1121834               </code></pre>
</div>
</div>
</section>
</div>
</div>
</div>
</section><section id="predictive-models" class="level2"><h2 class="anchored" data-anchor-id="predictive-models">Predictive models</h2>
<p>Here, we consider whether we can accurately predict cluster membership using age, sex, and the variables we found to be significantly associated with cluster membership: smoking at diagnosis, upper gastrointestinal inflammation (Montreal L4), and being prescribed a biologic therapeutic within one year of diagnosis. We consider two types of models: multinomial logistic regression models and a random forest classifiers using the <a href="http://www.stats.ox.ac.uk/pub/MASS4/">nnet</a> and <a href="https://github.com/imbs-hl/ranger">ranger</a> packages. We use the <a href="https://tidymodels.tidymodels.org">tidymodels</a> framework for fitting these models.</p>
<p>The data are split into a 75:25 train:test split and k-fold cross validation is used. Reported metrics and the confusion matrix are based on the test data split.</p>
<section id="all-clusters" class="level3"><h3 class="anchored" data-anchor-id="all-clusters">All clusters</h3>
<p>Firstly, we attempt to predict cluster membership for all four clusters.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb222"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html">relevel</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster</span>, ref <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># </span></span>
<span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">demographic</span>, prop <span class="op">=</span> <span class="fl">0.75</span>, strata <span class="op">=</span> <span class="va">cluster</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">cluster</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio3</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="multinomial-logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="multinomial-logistic-regression">Multinomial logistic regression</h4>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb223"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mlr_mod</span> <span class="op">&lt;-</span> <span class="fu">multinom_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">mlr_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mlr_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span></span>
<span>                         <span class="fu">penalty</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                         levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">mlr_grid</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>! Fold1: internal: No observations were detected in `truth` for level(s): '4'
Com...</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb225"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_mlr</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_mlr</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">extract_fit_engine</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span><span class="op">$</span><span class="va">call</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="fu">nnet</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nnet/man/multinom.html">multinom</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">cluster</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                                      <span class="va">DiagFC</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                                      <span class="va">use_bio3</span>,</span>
<span>                                  data <span class="op">=</span> <span class="va">train_data</span>,</span>
<span>                                  decay <span class="op">=</span> <span class="op">~</span><span class="fl">0.00316227766016838</span>, </span>
<span>                                  trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hmm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="odd-ratios" class="level5"><h5 class="anchored" data-anchor-id="odd-ratios">Odd ratios</h5>
<p>Point estimates:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb226"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">1.34</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">1.53</td>
<td style="text-align: right;">0.87</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.02</td>
<td style="text-align: right;">1.74</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">0.85</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.80</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">1.17</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">1.15</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Lower 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb227"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0.48</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">0.36</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.55</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Upper 95% confidence interval:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb228"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">$</span><span class="va">coefficients</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">*</span> <span class="va">hmm</span><span class="op">$</span><span class="va">standard.errors</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 2%">
<col style="width: 10%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 6%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">(Intercept)</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">SEXM</th>
<th style="text-align: right;">smokingyes</th>
<th style="text-align: right;">LOCATIONL2</th>
<th style="text-align: right;">LOCATIONL3</th>
<th style="text-align: right;">L4yes</th>
<th style="text-align: right;">behaviour2</th>
<th style="text-align: right;">behaviour3</th>
<th style="text-align: right;">periyes</th>
<th style="text-align: right;">DiagFC</th>
<th style="text-align: right;">use_bioY</th>
<th style="text-align: right;">use_bio3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">5.52</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">1.62</td>
<td style="text-align: right;">2.18</td>
<td style="text-align: right;">2.98</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">0.84</td>
<td style="text-align: right;">4.33</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.59</td>
<td style="text-align: right;">5.10</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">2.64</td>
<td style="text-align: right;">1.02</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">1.37</td>
<td style="text-align: right;">4.30</td>
<td style="text-align: right;">3.21</td>
<td style="text-align: right;">4.39</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">3.63</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">1.01</td>
<td style="text-align: right;">4.66</td>
<td style="text-align: right;">6.39</td>
<td style="text-align: right;">2.14</td>
<td style="text-align: right;">2.21</td>
<td style="text-align: right;">5.71</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">4.28</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.20</td>
<td style="text-align: right;">2.42</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="metrics" class="level5"><h5 class="anchored" data-anchor-id="metrics">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb229"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.6000000</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6187665</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb230"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="random-forest" class="level4"><h4 class="anchored" data-anchor-id="random-forest">Random forest</h4>
<section id="metrics-1" class="level5"><h5 class="anchored" data-anchor-id="metrics-1">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb231"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                      trees <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span>,</span>
<span>             num.threads <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>             importance <span class="op">=</span> <span class="st">"permutation"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="fu">trees</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tree_grid</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>! Fold1: internal: No observations were detected in `truth` for level(s): '4'
Com...</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb233"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_tree</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_tree</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">extract_fit_parsnip</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/vip/man/vi.html">vi</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Importance</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">use_bio</td>
<td style="text-align: right;">0.0074584</td>
</tr>
<tr class="even">
<td style="text-align: left;">DiagFC</td>
<td style="text-align: right;">0.0064232</td>
</tr>
<tr class="odd">
<td style="text-align: left;">L4</td>
<td style="text-align: right;">0.0060078</td>
</tr>
<tr class="even">
<td style="text-align: left;">use_bio3</td>
<td style="text-align: right;">0.0041954</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.0016984</td>
</tr>
<tr class="even">
<td style="text-align: left;">smoking</td>
<td style="text-align: right;">0.0012226</td>
</tr>
<tr class="odd">
<td style="text-align: left;">behaviour</td>
<td style="text-align: right;">0.0008770</td>
</tr>
<tr class="even">
<td style="text-align: left;">peri</td>
<td style="text-align: right;">0.0002500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LOCATION</td>
<td style="text-align: right;">-0.0006520</td>
</tr>
<tr class="even">
<td style="text-align: left;">SEX</td>
<td style="text-align: right;">-0.0008299</td>
</tr>
</tbody>
</table>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb234"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">multiclass</td>
<td style="text-align: center;">0.5777778</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">hand_till</td>
<td style="text-align: center;">0.6223638</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-1" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-1">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb235"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">2</th>
<th style="text-align: right;">1</th>
<th style="text-align: right;">3</th>
<th style="text-align: right;">4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Model performance for both the multinomial logistic regression model and the random forest classifier is very poor.</p>
</section></section></section><section id="cluster-2-16" class="level3"><h3 class="anchored" data-anchor-id="cluster-2-16">Cluster 2</h3>
<p>Due to the the clear separation in mean class profiles between cluster 2 and the other clusters and the poor model performance described above, we now consider binary outcome models which attempt to predict membership, or non-membership, of cluster 2.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb236"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demographic</span><span class="op">[</span><span class="va">demographic</span><span class="op">[</span>,<span class="st">"cluster"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span>, <span class="st">"cluster2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">demographic</span><span class="op">[</span><span class="va">demographic</span><span class="op">[</span>,<span class="st">"cluster"</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">2</span>, <span class="st">"cluster2"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">demographic</span><span class="op">$</span><span class="va">cluster2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">demographic</span>, prop <span class="op">=</span> <span class="fl">0.75</span>, strata <span class="op">=</span> <span class="va">cluster2</span><span class="op">)</span></span>
<span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span><span class="va">test_data</span>  <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span></span>
<span></span>
<span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">train_data</span>, v <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">cluster2</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span></span>
<span>                      <span class="va">SEX</span>  <span class="op">+</span></span>
<span>                      <span class="va">smoking</span> <span class="op">+</span></span>
<span>                      <span class="va">LOCATION</span> <span class="op">+</span></span>
<span>                      <span class="va">L4</span> <span class="op">+</span></span>
<span>                      <span class="va">behaviour</span> <span class="op">+</span></span>
<span>                      <span class="va">peri</span> <span class="op">+</span></span>
<span>                      <span class="va">FC.VALUE.AT.DIAGNOSIS</span> <span class="op">+</span> </span>
<span>                      <span class="va">use_bio</span> <span class="op">+</span></span>
<span>                      <span class="va">use_bio3</span>,</span>
<span>                    data <span class="op">=</span> <span class="va">test_data</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="logistic-regression" class="level4"><h4 class="anchored" data-anchor-id="logistic-regression">Logistic regression</h4>
<p>As we now considering a binary outcome, logistic regression via the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function is used instead of multinomial logistic regression.</p>
<section id="metrics-2" class="level5"><h5 class="anchored" data-anchor-id="metrics-2">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb237"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lr_mod</span> <span class="op">&lt;-</span> <span class="fu">logistic_reg</span><span class="op">(</span>penalty <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">lr_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lr_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">penalty</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                        levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">lr_grid</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning: No tuning parameters have been detected, performance will be evaluated
using the resamples with no tuning. Did you want to [tune()] parameters?</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>x Fold2: preprocessor 1/1, model 1/1 (predictions): Error in model.frame.default(...</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb240"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">best_lr</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_lr</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.6666667</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.6527778</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-2" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-2">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb241"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster2</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">39</td>
</tr>
</tbody>
</table>
</div>
</div>
</section></section><section id="random-forest-1" class="level4"><h4 class="anchored" data-anchor-id="random-forest-1">Random forest</h4>
<section id="metrics-3" class="level5"><h5 class="anchored" data-anchor-id="metrics-3">Metrics</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb242"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu">rand_forest</span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                      trees <span class="op">=</span> <span class="fu">tune</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                      mode <span class="op">=</span> <span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">set_engine</span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_wflow</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">rf_mod</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">add_recipe</span><span class="op">(</span><span class="va">class_rec</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tree_grid</span> <span class="op">&lt;-</span> <span class="fu">grid_regular</span><span class="op">(</span><span class="fu">mtry</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                          <span class="fu">trees</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                          levels <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">class_fit</span> <span class="op">&lt;-</span> <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu">tune_grid</span><span class="op">(</span></span>
<span>    resamples <span class="op">=</span> <span class="va">folds</span>,</span>
<span>    grid <span class="op">=</span> <span class="va">tree_grid</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">best_tree</span> <span class="op">&lt;-</span> <span class="va">class_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">select_best</span><span class="op">(</span><span class="st">"accuracy"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final_wf</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">class_wflow</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">finalize_workflow</span><span class="op">(</span><span class="va">best_tree</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">final_fit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">final_wf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">last_fit</span><span class="op">(</span><span class="va">data_split</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span></span>
<span>  <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span>, </span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Metric"</span>, <span class="st">"Estimator"</span>, <span class="st">"Estimate"</span>, <span class="st">"Config"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="st">"cccc"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: center;">Metric</th>
<th style="text-align: center;">Estimator</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Config</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">accuracy</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.4666667</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
<tr class="even">
<td style="text-align: center;">roc_auc</td>
<td style="text-align: center;">binary</td>
<td style="text-align: center;">0.5009921</td>
<td style="text-align: center;">Preprocessor1_Model1</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="confusion-matrix-3" class="level5"><h5 class="anchored" data-anchor-id="confusion-matrix-3">Confusion matrix</h5>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb243"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">final_fit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">cluster2</span>, <span class="va">results</span><span class="op">$</span><span class="va">.pred_class</span><span class="op">)</span>, row.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">28</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>However, model performance remains very poor.</p>
</section></section></section></section><section id="session-information" class="level2"><h2 class="anchored" data-anchor-id="session-information">Session information</h2>
<div class="cell">
<div class="cell-output-display">
<p><strong>R version 4.2.1 (2022-06-23)</strong></p>
<p><strong>Platform:</strong> x86_64-apple-darwin17.0 (64-bit)</p>
<p><strong>locale:</strong> en_GB.UTF-8||en_GB.UTF-8||en_GB.UTF-8||C||en_GB.UTF-8||en_GB.UTF-8</p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>datasets</em>, <em>utils</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>plyr(v.1.8.7)</em>, <em>KONPsurv(v.1.0.4)</em>, <em>vip(v.0.3.2)</em>, <em>patchwork(v.1.1.1)</em>, <em>survminer(v.0.4.9)</em>, <em>ggpubr(v.0.4.0)</em>, <em>survival(v.3.3-1)</em>, <em>ranger(v.0.13.1)</em>, <em>yardstick(v.0.0.9)</em>, <em>workflowsets(v.0.2.1)</em>, <em>workflows(v.0.2.6)</em>, <em>tune(v.0.2.0)</em>, <em>tidyr(v.1.2.0)</em>, <em>tibble(v.3.1.7)</em>, <em>rsample(v.0.1.1)</em>, <em>recipes(v.0.2.0)</em>, <em>purrr(v.0.3.4)</em>, <em>parsnip(v.0.2.1)</em>, <em>modeldata(v.0.1.1)</em>, <em>infer(v.1.0.0)</em>, <em>ggplot2(v.3.3.6)</em>, <em>dplyr(v.1.0.9)</em>, <em>dials(v.0.1.1)</em>, <em>scales(v.1.2.0)</em>, <em>broom(v.0.8.0)</em>, <em>tidymodels(v.0.2.0)</em> and <em>nnet(v.7.3-17)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>colorspace(v.2.0-3)</em>, <em>ggsignif(v.0.6.3)</em>, <em>ellipsis(v.0.3.2)</em>, <em>class(v.7.3-20)</em>, <em>rstudioapi(v.0.13)</em>, <em>listenv(v.0.8.0)</em>, <em>furrr(v.0.3.0)</em>, <em>farver(v.2.1.0)</em>, <em>prodlim(v.2019.11.13)</em>, <em>fansi(v.1.0.3)</em>, <em>lubridate(v.1.8.0)</em>, <em>codetools(v.0.2-18)</em>, <em>splines(v.4.2.1)</em>, <em>knitr(v.1.39)</em>, <em>jsonlite(v.1.8.0)</em>, <em>pROC(v.1.18.0)</em>, <em>km.ci(v.0.5-6)</em>, <em>compiler(v.4.2.1)</em>, <em>backports(v.1.4.1)</em>, <em>assertthat(v.0.2.1)</em>, <em>Matrix(v.1.4-1)</em>, <em>fastmap(v.1.1.0)</em>, <em>cli(v.3.3.0)</em>, <em>htmltools(v.0.5.2)</em>, <em>tools(v.4.2.1)</em>, <em>gtable(v.0.3.0)</em>, <em>glue(v.1.6.2)</em>, <em>Rcpp(v.1.0.8.3)</em>, <em>carData(v.3.0-5)</em>, <em>DiceDesign(v.1.9)</em>, <em>vctrs(v.0.4.1)</em>, <em>iterators(v.1.0.14)</em>, <em>timeDate(v.3043.102)</em>, <em>gower(v.1.0.0)</em>, <em>xfun(v.0.30)</em>, <em>stringr(v.1.4.0)</em>, <em>globals(v.0.14.0)</em>, <em>lifecycle(v.1.0.1)</em>, <em>renv(v.0.15.5)</em>, <em>rstatix(v.0.7.0)</em>, <em>future(v.1.25.0)</em>, <em>MASS(v.7.3-57)</em>, <em>zoo(v.1.8-10)</em>, <em>ipred(v.0.9-12)</em>, <em>ragg(v.1.2.2)</em>, <em>parallel(v.4.2.1)</em>, <em>yaml(v.2.3.5)</em>, <em>gridExtra(v.2.3)</em>, <em>pander(v.0.6.5)</em>, <em>KMsurv(v.0.1-5)</em>, <em>rpart(v.4.1.16)</em>, <em>stringi(v.1.7.6)</em>, <em>highr(v.0.9)</em>, <em>foreach(v.1.5.2)</em>, <em>lhs(v.1.1.5)</em>, <em>hardhat(v.0.2.0)</em>, <em>lava(v.1.6.10)</em>, <em>systemfonts(v.1.0.4)</em>, <em>rlang(v.1.0.2)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>evaluate(v.0.15)</em>, <em>lattice(v.0.20-45)</em>, <em>datefixR(v.0.1.4)</em>, <em>htmlwidgets(v.1.5.4)</em>, <em>labeling(v.0.4.2)</em>, <em>tidyselect(v.1.1.2)</em>, <em>parallelly(v.1.31.1)</em>, <em>magrittr(v.2.0.3)</em>, <em>R6(v.2.5.1)</em>, <em>generics(v.0.1.2)</em>, <em>DBI(v.1.1.2)</em>, <em>pillar(v.1.7.0)</em>, <em>withr(v.2.5.0)</em>, <em>abind(v.1.4-5)</em>, <em>future.apply(v.1.9.0)</em>, <em>crayon(v.1.5.1)</em>, <em>car(v.3.0-13)</em>, <em>survMisc(v.0.5.6)</em>, <em>utf8(v.1.2.2)</em>, <em>rmarkdown(v.2.14)</em>, <em>grid(v.4.2.1)</em>, <em>data.table(v.1.14.2)</em>, <em>digest(v.0.6.29)</em>, <em>xtable(v.1.8-4)</em>, <em>textshaping(v.0.3.6)</em>, <em>GPfit(v.1.0-8)</em> and <em>munsell(v.0.5.0)</em></p>
</div>
</div>
</section><div id="quarto-appendix" class="default"><section id="section" class="level2 appendix"><h2 class="quarto-appendix-heading"></h2><div class="quarto-appendix-contents">
<p><img class="center" src="images/MRC_HGU_Edinburgh%20RGB.png" alt="MRC Human Genetics Unit logo" height="50px"><img src="images/cgem-logo.png" alt="Centre for Genomic &amp; Experimental Medicine logo" height="50px"></p>
</div></section><section id="acknowledgments" class="level2 appendix"><h2 class="quarto-appendix-heading">Acknowledgments</h2><div class="quarto-appendix-contents">
<p>This work is funded by the Medical Research Council &amp; University of Edinburgh via a Precision Medicine PhD studentship (MR/N013166/1, to <strong>NC-C</strong>)</p>
</div></section><section id="author-contributions" class="level2 appendix"><h2 class="quarto-appendix-heading">Author contributions</h2><div class="quarto-appendix-contents">
<p><strong>NC-C</strong> wrote the analysis. <strong>KM</strong> and <strong>CAV</strong> performed code review and contributed suggestions. <strong>RM</strong> contributed functions for calculating descriptive statistics. <strong>KM</strong>, <strong>RM</strong> and <strong>CAV</strong> provided feedback.</p>
</div></section><section id="reuse" class="level2 appendix"><h2 class="quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents">
<p>Licensed by <a href="https://creativecommons.org/licenses/by/4.0/">CC BY </a> unless otherwise stated.</p>



</div></section><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Peto1972" class="csl-entry" role="doc-biblioentry">
Peto, Richard, and Julian Peto. 1972. <span>“Asymptotically Efficient Rank Invariant Test Procedures.”</span> <em>Journal of the Royal Statistical Society. Series A (General)</em> 135 (2): 185. <a href="https://doi.org/10.2307/2344317">https://doi.org/10.2307/2344317</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/IBDNathan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>